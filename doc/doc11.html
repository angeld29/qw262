<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>QW262 documentation (revision 11)</title>
<link rel="stylesheet" type="text/css" href="doc.css">
</head>
<body>
<h2>QW262 by [2WP]BorisU revision 11</h2>
<h2>Как все начиналось</h2>
<p>В конце 1999 года Id Software выложила для свободного доступа исходники Quake1,
включая QuakeWorld. С одной стороны это было хорошо, так как стало возможным добавить
новые возможности в клиенты. С другой - практически сразу появились читерские
клиенты и прокси со встроенным autoaim'ом и кучей других читов. На Физтехе (Московский
Физико-Технический Институт - для тех, кто не в курсе :) ) возникла идея сделать
клиент и сервер с измененным протоколом и закрытым кодом, дабы жестоко обломать
читеров. В январе 2000 года физтеховские сервера были переведены на эту измененную
версию QW, написанную <u>-=MD=-</u> (Александр Пучков). Поскольку на физтехе был
весьма популярен TeamFortress, то кроме античитерских фич в клиент были добавлены
некоторые возможности облегчающие жизнь игроку в TF. Модифицированный QW ставили
на DemosTF, но из-за проблем с загрузкой сервера работой, а не игрушками :) Quake
сервера вскоре были снесены. Оказалось, что возможности нового клиента полезны
сами по себе и в клиент была возвращена возможность работать на протоколе 2.30.
В начале Октября 2000г. <u>-=MD=-</u> передал исходники мне (<u>BorisU</u>), так
как сам не имел свободного времени для работы над клиентом.
<h2>Основные возможности и преимущества клиента</h2>
<ul>
<li>В TeamFortress не работают антифлэш и антиконк читы (old_grens on).
<li>В GL версии клиента в TeamFortress эффект flash и gas гранат максимально приближен
к их действию в software режиме.</li>
<li>В GL версии можно регулировать gamma'у и contrast не отсоединяясь от сервера.</li>
<li>Новый алгоритм записи демок (с включенной delta_compression). В старых
клиентах при записи демок delta_compression выключается автоматически, что часто
приводит к скачкам ping'а и увеличению PL.</li>
<li>Возможно записывать демку во время проигрывания qwd-демки и таким образом 
вырезать из нее куски.</li>
<li>Встроенная поддержка некоторых функций proxy (qizmo и т.д) таких как:<br>
<a href="#locfile">loc-файлы</a> (разметка карт) двух типов, qizmo и собственный
(блочный) формат;<br>
<a href="#macros">макросы</a> в сообщениях (%l, %a, %h и др.). Некоторые из них
сильно усовершенствованны. Например, есть возможность передавать свои физические
координаты на карте, а значит, каждый сможет интерпретировать их в зависимости
от своих <a href="#locfile">loc-файлов</a>.</li>
<li><a href="#filter">Фильтрация сообщений</a>;</li>
<li>Кое-что из fps фильтра.</li>
<li>Улучшенное проигрывание демок, включая QWZ и MVD демки. Встроенный броузер
демок.</li>
<li>Улучшена работа в консоли.</li>
<li>Возможность определять такие клавиши как: capslock, numlock, и все клавиши
цифровой клавиатуры.</li>
<li>Поддерживаются мыши с 4мя и более кнопками.</li>
<li>Есть возможность вывести на экран любую необходимую для вас информацию в виде
<a href="#hud">hud bar</a>'а (например: жизнь, броню, патроны, или состояние какой-нибудь
переменной, например, fov)</li>
<li>Для еще большей защиты от читеров есть возможность работать на <a
href="#qw262">измененном протоколе</a>, несовместимом с другими клиентами и прокси</li>
</ul>
<p>Множество дополнительных <a
href="#common">настроек и возможностей</a> </p>
<ul>
<li> Улучшенная работа со <a
href="#script">скриптами</a>, по своей сути это уже похоже на отдельный макро
язык в который входит:
<ul>
<li>Мощная работа с переменным (подстановка, поиск и др.)
<li>Усовершенствованная работа с alias'ами (в несколько раз ускорен их поиск и
выполнение, есть возможность для написания вложенных alias'ов, разрешена передача
параметров)
<li>Математические функции - сложение, вычитание, умножение и другие
<li>Условное выполнение команд - <b>if/then/else</b>
<li>Улучшенное ведения log'ов консоли с сохранением их на диск;
</ul>
<li>А самое главное - возможность автоматизации некоторых действий при помощи
<a href="#regexp">regexp-триггеров</a>. Это мощнейший инструмент для обработки
событий! Теперь, почти для всех появляющихся на экране и в консоли сообщений,
можно установить выполнение определенного alias'а. Область их применения огромна,
но минимум их использования, это продвинутая коммуникация со своими членами команды,
или добавление определенных событий, которых не хватает в некоторых MOD'ах или
картах.
<li>В качестве эксперимента в клиент встроен интерпретатор языка программирования <a href="#tcl">Tcl</a>.
</ul>
<a name=common></a>
<h2>Дополнительные настройки и возможности</h2>
<p>Клиент автоматически отвечает на запрос f_version посланный любым игроком в
messagemode1. Ответ на запрос идет не чаще, чем раз в 20 секунд во избежание флуда.</p>
<p>Если в вашем конфиге присутствует строка <b>setinfo uid nick</b>, то nick становится
вашим идентификатором (любая строка до 5 символов, case-sensitive), что полезно
если вы любите играть под "левым" ником. Эта переменная отображается в userinfo
и все играющие с клиентом версии 2.62 могут увидеть ее по команде <b>users</b>.
Некоторые команды qw262 принимают uid наравне с id игрока.</p>
<p>Громкость звука издаваемого командами <b>play</b> и <b>playvol</b> не зависит
от того, насколько далеко вы смогли за это время убежать. Весьма полезно для таймеров
гранат в TeamFortress.</p>
<p>При выдвигании консоли корректируется поле зрения (как в unreal, работает только
в софте).<br>
Чтобы пользователи GL-версии не чувствовали себя обделенными, теперь можно регулировать
прозрачность консоли переменной <b>gl_conalpha</b> (по умолчанию 0.8). При значениях
около 0.3 через консоль все прекрасно видно и нет необходимости корректировать
поле зрения.</p>
<p>Клиент определяет есть ли jumpfix на сервере и ведет себя соответственно при
prediction. </p>

<p>
Команда <b>impulse</b> теперь может выбирать лучшее оружие из списка.
Пример: <b>impulse 8 3 2</b>.</p>

<h3>Изменения для некоторых команд и переменных.</h3>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>rate</b></td>
<td>
<p>Максимальное значение <b>rate</b> увеличено до 15000. Однако &gt;10000 вам
реально удастся получить только с сервером версии QW262</p>
</td>
</tr>
<tr>
<td valign=top><b>cl_maxfps</b></td>
<td>
<p>возможен fps выше 72 (до 120), но только если на сервере стоит serverinfo maxfps
или при просмотре демок. </p>
</td>
</tr>
<tr>
<td valign=top><b>user</b></td>
<td>дополнительно показывает полный размер userinfo в байтах. При игре на сервере
2.30 эта величина не может превышать 196 байт (255 байт для QW262). При игре в
TeamFortress выводит skin, topcolor и bottomcolor только для игроков из своей
команды.</td>
</tr>
</tbody>
</table>
<h3>Визуальные настройки</h3>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td noWrap><b>crosshair 3</b></td>
<td>Маленький крестик цвета <b>crosshaircolor</b></td>
</tr>
<tr>
<td valign=top noWrap><b>crosshair 4</b></td>
<td>Крест цвета <b>crosshaircolor</b>, размер регулируется переменными <b>cl_cross_size,
cl_cross_width</b></td>
</tr>
<tr>
<td valign="top"><b>cl_crosshair_hack</b></td>
<td>Значение 1 (по умолчанию 0) слегка смещает точку зрения так, чтобы crosshair
примерно совпадал с точкой от снайперской винтовки в TF.</td>
</tr>
<tr>
<td><b>cl_nolerp</b></td>
<td>Значение 0 (по умолчанию 1) включает интерполяцию моделей и анимации, объекты в игре при этом движутся более плавно.</td>
</tr>
<tr>
<td valign="top"><a name=load_charset></a><b>load_charset name</b></td>
<td>Позволяет менять charset на лету. Текстура грузится из папок <i>/textures/charsets/</i>
или <i>/textures/</i>. Текстура шрифта представляет собой файл одного из поддерживаемых форматов (DDS, JPG, PNG, TGA или PCX), в котором хранится графическое изображение 256 символов. Работает только в GL-версии.</td>
</tr>
<tr>
<td valign=top><b>default_fov</b></td>
<td>Когда с сервера приходит команда установки<b> fov 90</b>, то вместо этого
выставляется значение <b>default_fov</b>. Полезно использовать в TeamFortress,
если вы играете с нестандартным <b>fov</b></td>
</tr>
<tr>
<td valign=top><b>r_drawviewmodel</b></td>
<td>При значении 1 моделька оружия видна всегда. При значении 2 только при fov &lt;=90 (по умолчанию). Также поддерживается прозрачность модели оружия. Для этого нужно указать лишь дробное значение этой переменной. Например: 2.5 - сделает модельку наполовину прозрачной.</td>
</tr>
<tr>
<td valign=top><b>r_viewmodelsize</b></td>
<td>Регулирует размер модельки оружия на экране, диапазон изменения 0 - 1 (1 по умолчанию). </td>
</tr>
<tr>
<td valign=top><b>show_speed</b></td>
<td>
<p>значение 1 включает показ в статус баре скорости передвижения вместо количества
патронов (как в Qizmo) (по умолчанию 0). Значения 2 и 3 выводят графический спидометр.</p>
</td>
</tr>
<tr>
<td><b>show_lagmeter</b></td>
<td>значение 1 включает показ в правом нижнем углу экрана ping и packetloss (по
умолчанию 0)</td>
</tr>
<tr>
<td><b>lagmeter_format</b></td>
<td>если эта переменная равна 1, то lagmeter становится более компактным (по умолчанию
0)</td>
</tr>
<tr>
<td valign=top><b>con_notifylines</b></td>
<td>Определяет число строк вверху экрана, где показываются сообщения консоли (по
умолчанию 4)</td>
</tr>
<tr>
<td valign=top><b>scr_centershift</b></td>
<td>Определяет сдвиг для сообщений выводимых по centerprint. Положительное значение
- вниз. Полезно при просмотре TeamFortress демок записанных в другом разрешении</td>
</tr>
<tr>
<td valign=top><b>scr_consize</b></td>
<td>Регулирует размер консоли в игре. Диапазон значений от 0 до 1 (по умолчанию
0.5).</td>
</tr>
<tr>
<td valign=top><b>conwidth</b></td>
<td>Регулирует масштаб консоли и HUD, должно быть меньше или равно ширине экрана в пикселах. Высота консоли вычисляется исходя из пропорции 4:3.</td>
</tr>
<tr>
<td valign=top><b>r_drawflame</b></td>
<td>Если 0 (по умолчанию 1), то убирает факелы, которые неразумные дизайнеры уровней
вставляют для понижения fps :)</td>
</tr>
<tr>
<td valign=top><b>r_powerupglow</b></td>
<td>Если 0 (по умолчанию 1), то убирает динамическое освещение от powerups. Значение
2 убирает этот эффект только для своих powerups.</td>
</tr>
<tr>
<td valign=top><b>r_lightflicker</b></td>
<td>Если 0 (по умолчанию 1), то динамическое освещение от powerups не мерцает.
</td>
</tr>
<tr>
<td valign=top><b>r_rocketlight</b></td>
<td>Если 0 (по умолчанию 1), то убирает динамическое освещение от ракет. Может принимать дробные значение, регулируя размер освещения от ракет. 
</td>
</tr>
<tr>
<td valign=top><b>r_rocketlightcolor</b></td>
<td>Задает цвет динамического освещения от ракет. Диапазон изменения 0-5. Работает только при gl_colorlights 1.
</td>
</tr>
<tr>
<td valign=top><b>r_flagcolor</b></td>
<td>Задает цвет динамического освещения от флагов в TF. Диапазон изменения 0-5. Работает только при gl_colorlights 1.
</td>
</tr>
<tr>
<td valign=top><b>cl_explosion</b></td>
<td>Если 2 (по умолчанию 0), то убирает динамическое освещение от взрывов</td>
</tr>
<tr>
<td valign=top><b>r_fastsky</b></td>
<td>Установка в 1 (по умолчанию 0), рисует однотонную текстуру вместо неба, цвет
определяется автоматически из текущей текстуры неба.</td>
</tr>
<tr>
<td valign=top><b>r_fastblack</b></td>
<td>Установка в 1 (по умолчанию), включает ускоренную 
отрисовку черных поверхностей (например небо на well). Ускорение тем заметнее, 
чем слабее видеокарточка. Оценить выигрыш можно выйдя на поле на well и сделав 
timerefresh со значениями <tt>r_fastblack</tt> 0 и 1.</td>
</tr>
<tr>
<tr>
<td valign=top><b>r_farclip</b></td>
<td>Определяет дальнюю границу, за которой ничего не отрисовывается.
Большие значения избавляют от глюков отрисовки на картах с большими открытыми пространствами (xpress, hunted etc).
По умолчанию 4096.
</td>
</tr>
<tr>
<td valign=top><b>cl_muzzleflash</b></td>
<td>Управляет показом вспышек от выстрелов, 0 - не показывать, 2 - не показывать
только свои (по умолчанию 1)</td>
</tr>
<tr>
<td valign=top><b>cl_sbar_inv</b></td>
<td>Если эта переменная равна 0, то inventory не показывается в статус баре независимо
от значения <b>viewsize</b></td>
</tr>
<tr>
<td valign=top><b>r_netgraph</b></td>
<td>Может принимать значения 2 (не рисуется фон у графика) и 3 (дополнительно
убирается надпись про PL)</td>
</tr>
<tr>
<td valign=top><b>r_fullbrightskins</b></td>
<td>задает минимальный уровень освещенности игроков. Диапазон значений от 0 (нормальное
освещение) до 1 (fullbright скины). Работает только при просмотре демок или если
сервер явным образом разрешает это (<b>serverinfo fbskins x</b>, x задает максимальный
разрешенный уровень яркости).</td>
</tr>
<tr>
<td valign=top><b>cl_truelightning</b></td>
<td>изменяет отображение шафта. Диапазон значений: 0-1. Действует только при проигрывании
демок или при явном разрешении сервера (<b>serverinfo truelightning</b>).</td>
</tr>
<tr>
<td valign=top><b>v_damagecshift</b></td>
<td>Регулирует покраснение экрана при получении повреждений. По умолчанию - 1,
доступный диапазон 0 - 1.</td>
</tr>
<tr>
<td valign=top><b>v_quadcshift, v_suitcshift, v_ringcshift, v_pentcshift</b></td>
<td valign="top">Регулирует изменение цвета экрана при действии соответствующего
powerup. По умолчанию - 1, доступный диапазон 0 - 1.</td>
</tr>
<tr>
<td valign=top><b>cl_bonusflash</b></td>
<td valign="top">Включает/выключает изменение цвета экрана при взятии оружия,
патронов etc. По умолчанию - 1.</td>
</tr>
<tr>
<td valign=top><b>cl_swapredblue</b></td>
<td valign="top">Установка в 1 (0 по умолчанию) позволит поменять местами цвета команд в TF.</td>
</tr>
<tr>
<td valign=top><b>cl_ignore_topcolor</b></td>
<td valign="top">Если установить в 1 (0 по умолчанию), то цвет рубашки игрока будет соответствовать цвету его штанов.</td>
</tr>

<td valign=top><b>m_rate</b></td>
<td valign="top">Встроен алгоритм сглаживания движения мыши. Если клиент запущен с ключиком
-m_smooth (без -dinput не работает), то этой переменной можно регулировать механизм сглаживания. Для оптимального сглаживания должно совпадать с реальной
частотой опроса мыши. Пример:
<pre>
qwcl262.exe -m_smooth
в autoexec.cfg прописывам:
m_rate 125 // для USB подключений (по умолчанию)
m_rate 80 // для bluetooth мышей
m_rate 200 // для PS/2 мышек
</pre></td>
</tr>
<tr>
<td valign=top>Переменная <b>m_yaw</b></td>
<td valign="top">запоминается в config.cfg</td>
</tr>
</tbody>
</table>
<p>
В клиент встроены дополнительные переменные, управляющие видом sbar: <b>scr_centerSbar 0-1</b>, <b>scr_centerSbar 0-1</b>, <b>scr_compactHud 0-3</b>, <b>scr_scr_compactHudAlign 0-1</b>, <b>scr_drawHFrags 0-2</b>, <b>scr_drawVFrags 0-2</b>.</p>
<p>
А также встроен новый scoreboard (пока что без учета фрагов и флагов).<br>
Управляется переменными <b>scr_scoreboard_new</b>, <b>scr_scoreboard_teamsort</b>, <b>scr_scoreboard_drawtitle</b>, <b>scr_scoreboard_borderless</b>, <b>scr_scoreboard_fillalpha</b>, <b>scr_scoreboard_fillcolored</b>.
Переменная <b>scr_coloredText</b> управляет возможностью вывода цветного текста. Пока едиственным местом, где это заметно, является надпись SPECTATOR в scoreboard :)</p>

<p>Клиент поддерживает биты в fpd запрещающие скриптовые fwrj (32768) и rj (16384).</p>

<p>В клиент/сервер встроена технология ускоренной закачки файлов. Серверная переменная <b>sv_maxdownloadrate</b> отвечает
за ограничичение скорости закачки. По умолчанию она равна 0 и скорость закачки ограничивается <b>sv_maxrate</b>.
Максимальное значение <b>sv_maxdownloadrate</b> - 100000.
Со стороны клиента скорость закачки определяется <b>setinfo drate</b> (или <b>rate</b> при отсутствии <b>drate</b>).
существенных переменных. Это уменьшает траффик, размер демок и решает проблему с
переполнением userinfo.</p>

<h3>Отличия GL версии</h3>
<p>Поддерживаются LIT-файлы (статическое цветное освещение).
Переменная <b>gl_loadlitfiles</b> (1 по умолчанию) указывает, загружать ли .lit файлы или нет.
Они грузятся из каталогов <b>maps </b>или <b>lits</b>. Работает только если переменная <b>gl_colorlights</b>
установлена в 1.</p>
<p>Возможно использование 24/32bit текстур в формате JPG, PNG, большего количества разновидностей TGA (grayscale, 8-bit) и PCX (поиск
производится именно в этом порядке!) размером до 2048x2048. При загрузке текстуры
с именем 'test' сначала ищется файл test.link (указывает где реально лежит текстура)
затем test.jpg, tes.png, test.tga, test.pcx и в последнюю очередь берутся 8bit
текстуры из стандартных мест. Если имя текстуры начинается с '*', то этот символ
заменяется на '#'. <i>Поддержка fullbright цветов на 24/32bit текстурах должна
быть разрешена на сервере через '<b>serverinfo 24bit_fbs 1</b>'</i>.</p>
<p>Можно использовать 24/32bit текстуры для bsp-моделей, alias-моделей, спрайтов,
элементов интерфейса (меню, статусбар), скайбоксов и прицелов. Данная табличка
показывает, из каких каталогов грузятся текстуры. У alias-моделей увеличен лимит на чисо вертексов. Теперь возможно 
использовать hi-poly версии ящиков с амуницией и моделек оружия. Например, вот <a href="http://paginas.terra.com.br/informatica/requake/">этих</a>.</p>
<p>Поддерживаются текстуры в формате .DDS (предварительно сжатые по методу S3TC,
коэффициент сжатия до 8:1).
Их загрузка существенно быстрее, чем сжатие текстур драйвером при ненулевых значениях
<b>gl_ext_texture_compress</b>. Конвертор в этот формат
можно найти на сайте nVidia:
<a href="http://developer.nvidia.com/docs/IO/1176/ATT/DXT_TOOLS_v5.19.zip">DXT Compression Tools (1433 KB)</a>.
Следует помнить, что эти текстуры загружаются в
карточку как есть, без гамма-коррекции, так что при их использовании стоит поставить в
командную строку -gamma 1 (или -mtfl) иначе они будут слишком темными.</p>
<p>Поддерживаются *_luma текстуры (что это такое читать на 
<a href="http://www.quake.cz/winclan/qe1/">QE1 Retexturing project</a>.
luma текстуры разрешены для тех текстур, которые имеют в названии "light", "lit" или "rune" и все анимационные текстуры (начинаются с '+').</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tr>
<td>bsp-модели (стенки, аптечки etc.)</td>
<td><b>textures/mapname</b>, <b>textures/bmodels</b>,<b> textures</b></td>
</tr>
<tr>
<td>alias-модели (оружие, армор, etc. кроме player.mdl!)</td>
<td><b>textures/models</b>, <b>textures/progs</b>,<b> textures</b></td>
</tr>
<tr>
<td>cпрайты</td>
<td><b>textures/sprites</b>, <b>textures/progs</b>,<b> textures</b></td>
</tr>
<tr>
<td>текстуры для skybox</td>
<td><b>textures/skybox, env</b></td>
</tr>
<tr>
<td>текстуры для замены элементов интерфейса</td>
<td><b>textures/gfx</b>, <b>textures/wad</b>, <b>gfx</b></td>
</tr>
<tr>
<td>прицелы</td>
<td><b>testures/crosshairs</b></td>
</tr>
</table>
<p>Фон для консоли ищется в <b>/textures/gfx/conback.*</b>. Используемы й в консоли
шрифт ищется в <b>/textures/charset.*</b>. </p>
<p></p>
<p>Несколько о слов о .link файлах. Это чисто текстовый файл в котором лежит название
текстуры (можно с путем и обязательно с расширением). Например если <b>some_texture.link</b>
содержит строку <b>TFcommon/blue_wall.tga</b>, то при попытке загрузить <b>some_texture</b>
будет загружена <b>blue_wall.tga</b> из указанного каталога. Таким образом можно
избежать ненужного дублирования текстур, а заодно дать и разумные названия.</p>
<p>Поддерживаются skybox. Имя желаемого skybox надо занести в переменную <b>r_skybox</b>

<p>Встроена команда <b>mapgroup</b>, позволяющая модифицировать алгоритмы поиска loc-файла, 24bit текстур и .lit-файлов.
Если loc-файл с именем mapname не найден, то делается попытка загрузить loc-файл
с именем groupname. Текстуры ищутся сначала в textures/mapname/, затем в
textures/groupname/ и далее как раньше. Имя текущей группы доступно через read-only 
переменную <tt>mapgroupname</tt>.
<pre>// выдает список групп
mapgroup
// очищает список групп
mapgroup clear
// задает группу groupname для карт map1, map2 ...
mapgroup groupname map1 [map2 ...]
// удаляет группу groupname
mapgroup groupname clear</pre>
Пример:
<pre>mapgroup 2fort5 2fort5r 2fort5l
mapgroup wellgl1 well6</pre>
</p>

или использовать команду <b>loadsky skyboxname</b>. Текстуры для skybox имеют
имена <b>namexx.*</b> или <b>name_xx.*</b> (где xx: rt, bk, lf, ft, up, dn). В
связи с некоторыми проблемами их отрисовки и возможностью использования их для
читерства в старых клиентах, использование skybox должно быть разрешено на сервере через '<b>serverinfo
allow_skybox 1</b>', в последних версиях эти проблемы устранены и skybox'ы разрешены всегда.</p>
<p>Поддерживается 32bit текстура для рисования прицела (<b>crosshair 5</b>). Желаемая
текстура грузится командой <b>load_crosshair name</b>, причем автоматом дается команда <b>crosshair 5</b>. Поддерживается частичная
прозрачность. Размер и цвет задаются переменными <b>cl_crosssize</b> и <b>crosshaircolor.</b></p>
<p>Некоторые драйвера от nVidia при запросе 32bit Z-buffer включают только 16bit,
что приводит к артефактам рендеринга. Теперь клиент по дефолту запрашивает 
24bit Z-buffer и можно самому задать желаемую точность ключиком -zbuf в командной строке. Пример: 
<pre>qwcl262 -bpp 32 -zbuf 24</pre></p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tr>
<td valign=top><b>vid_hwgammacontrol</b></td>
<td>
<p>Если 1 (по умолчанию, если ваш видеоадаптер аппаратно поддерживает загрузку
gammaramp), то в GL-версии становится возможным регулировать значение <b>gammа</b>,
а также шпионский газ в TeamFortress работает точно также, как и в software режиме.<br>
При значении 2 можно регулировать gamma в процессе игры, как при 1, но все эффекты
отрабатываются, как при значении 0. Рекомендуется использовать значение 2 при
игре под Win2000/WinXP. <br>
Если вы играете с <b>vid_hwgammacontrol 0</b>, то для регулировки <b>gamma</b>
необходимо задавать ключ <b>-gamma</b> в командной строке при запуске клиента.
</p>
</td>
</tr>
<tr>
<td valign=top><b>gl_texturebits</b></td>
<td>
<p>Управляет тем, в каком формате грузятся текстуры в видеокарточку.
Может принимать значения 32 (выше качество, больше расход памяти, ниже скорость), 
16 (ниже качество, меньше расход памяти, выше скорость), 
0 (на усмотрение драйвера, по умолчанию).</p>
</td>
</tr>
<tr>
<td valign=top><b>gl_flush_textures</b></td>
<td>выгружает текстуры из памяти видеокарточки.
</td>
</tr>
<tr>
<td valign=top><b>gl_fb_models</b></td>
<td>
<p>Если 1 (по умолчанию), то осуществляется поддержка fullbright цветов в GL-версии
для текстур на bsp-моделях (стенки, аптечки etc.)</p>
</td>
</tr>
<tr>
<td valign=top><b>gl_fb_bmodels</b></td>
<td>Если 1 (по умолчанию), то осуществляется поддержка fullbright цветов в GL-версии
для текстур на alias-моделях (игроки, гранаты etc.)</td>
</tr>
<tr>
<td valign=top><b>gl_player_interpolate</b></td>
<td>Если 1 (по умолчанию), то осуществляется интерполяция для модели игрока, что
дает более плавное движение.</td>
</tr>
<tr>
<td valign=top><b>gl_lightmode </b></td>
<td>Управляет типом динамического освещения (0 - стандарт GLQuake, 2 - ZQuake,
изменения вступают в силу после рестарта карты.</td>
</tr>
<tbody>
<tr>
<td valign=top><b>gl_colorlights </b></td>
<td>Если 1 (по умолчанию 0), то в GL-версии включает цветное динамическое освещение
(действует при gl_flashblend 0, изменения вступают в силу после рестарта карты).
</td>
</tr>
<tr>
<td valign=top><b>gl_flares</b></td>
<td>
Если 0, то ракеты в GL-версии имеют красивый светящийся хвост.
</td>
</tr>
<tr>
<td valign=top><b>r_grenadetrail</b></td>
<td>Включает/выключает хвосты у гранат, в том числе и для моделек гранаты типа DOXовской.
</td>
</tr>
<tr>
<td valign=top><b>r_rockettrail</b></td>
<td>Большой выбор альтернативных хвостов для ракет r_rockettrail (0-8).
</td>
</tr>
<tr>
<td valign=top><b>gl_qmb_particles</b></td>
<td>
<p>Встроен particle engine из <a href="http://qmb.quakepit.com">QMB</a>.
Изменения вступают в силу при загрузке карты. Для работы нужны <a href="http://2wp.vei.ru/files/qmb_particles.rar">эти текстуры</a>.</p>
</td>
</tr>
<tr>
<td valign=top><b>scr_scalemenu </b></td>
<td>Если 1 (по умолчанию), то меню растягивается на весь экран.</td>
</tr>
<tr>
<td valign=top><b>r_watervishack</b></td>
<td>Частично фиксит глюки с показом entities, когда точка зрения находится вблизи
поверхности воды (по умолчанию 1). </td>
</tr>
<tr>
<td valign=top><b>gl_smoothfont</b></td>
<td>Определяет, надо ли сглаживать шрифт в консоли (по умолчанию 0).</td>
</tr>
<tr>
<td valign=top><b>gl_waterfog</b></td>
<td> Управляет отображением дымки под водой. Возможные значения: 0 - отключено,
1 - Linear Fog, 2 - Exponential Fog (по умолчанию 2).</td>
</tr>
<tr>
<td valign=top><b>gl_waterfogdensity</b></td>
<td>Регулирует силу эффекта. Диапазон значений: 0 - 1.</td>
</tr>
<tr>
<td valign=top><b>gl_caustics </b></td>
<td>Управляет отображением бликов на подводных поверхностях (по умолчанию 1).
Чтобы это работало нужна текстура <b>water_caustic</b>, которую надо положить
в <b>qw/textures</b>. Работает только при <b>gl_texsort</b> установленном в 0.</td>
</tr>
<tr>
<td valign=top><b>gl_weather_rain</b></td>
<td>Если больше 0, с неба начинает идти дождь. Значение регулирует интенсивность дождя.</td>
</tr>
<tr>
<td valign=top><b>gl_weather_rain_fast</b></td>
<td>Если 1, на поверхности воды не отображаются круги от капель.</td>
</tr>
<tr>
<td valign=top><b>gl_use_24bit_textures</b></td>
<td>Разрешает использовать 24bit текстуры (по умолчанию 1).</td>
</tr>
<tr>
<td valign=top><b>gl_screenshot_format</b></td>
<td>Определяет в каком формате записываются на диск скриншоты. Влияет и на команду
<b>capture</b>. Возможные значения: 0 - TGA (default), 1 - PNG, 2 -JPG. Скриншоты сохраняются в папку gamedir/screenshots/. Максимальное 
количество скриншотов составляет 9999.</td>
</tr>
<tr>
<td valign=top><b>gl_screenshot_png_compression </b></td>
<td>Регулирует степень сжатия скриншотов в формате PNG. Диапазон значений 1-9,
чем больше, тем сильнее и тормознее сжатие, 0 - default libpng (соответствует
6 в данной версии библиотеки).</td>
</tr>
<tr>
<td valign=top><b>gl_screenshot_jpg_quality</b></td>
<td>Регулирует степень сжатия скриншотов в формате JPG. Диапазон значений 1-100,
чем больше, тем выше качество и больше размер, 0 - default libjpeg (соответствует
~75 в данной версии библиотеки). </td>
</tr>
<tr>
<td valign=top><b>gl_ext_anisotropy_level</b></td>
<td>Задает уровень анизотропной фильтрации. Значение 0 (по умолчанию)оставляет
анизотропию на усмотрение драйвера. Другие значения: 1 (отключение анизотропной
фильтрации), 2, 4 ... и т.д. до максимального уровня, разрешаемого видеокарточкой,
явно применяются при фильтрации. Переключать можно прямо на ходу. </td>
</tr>
<tr>
<td valign=top><b>gl_ext_automipmap</b></td>
<td>
<p>Разрешает использование OpenGL-расширения для автоматичеcкого создания mipmap'ов.
По умолчанию включено (1), владельцам ATI Radeon стоит порекомендовать установить эту переменую в 0,
так как при загрузке скинов могут возникать серьезные лаги.</p>
</td>
</tr>
<tr>
<td valign=top><b>gl_ext_texture_compress</b></td>
<td>Регулирует сжатие текстур при загрузке в видеокарточку. По дефолту выключено
(0). Значения &gt; 0 работают так: если log<sub>2</sub>(width*height) больше или
равно значению данной переменной, то текстура сжимается при загрузке в карту.
Таким образом при значении 16 будут сжиматься только текстуры с размером больше
256x256. На некоторых видеокарточках сжатие текстур может дать немалую прибавку
скорости</td>
</tr>
<tr>
<td valign=top><b>gl_ext_lod_bias</b></td>
<td>Регулирует LOD bias. По умолчанию 0. Допустимый диапазон : от -3 до 3. Положительные
значения дают эффект похожий на <b>gl_picmip</b> с той разницей, что можно это
регулировать прямо во время игры. Отрицательные значения дают более резкую картинку,
но могут приводить к мерцанию далеко расположенных текстур.</td>
</tr>
<tr>
<td valign=top><b>gl_blend_sprites</b></td>
<td>При значении 0 спрайты отрисовываются так же, как и в других клиентах :).
При установке в 1 (default) поддерживается частичная прозрачность и спрайты получше
выглядят. При этом слегка выше загрузка процессора и видеокарточки. </td>
</tr>
<tr>
<td valign=top><b>gl_fb_depthhack</b></td>
<td valign="top">Регулирует силу эффектов, изменяющих цвет экрана. По умолчанию
- 100. Допустимый диапазон 0-100.</td>
</tr>
<tr>
<td valign=top><b>vid_vsync</b></td>
<td>Позволяет включать/выключать синхронизацию смены кадров и развертки (default
0 - выключено). Только в Win32 версии.</td>
</tr>
<tr>
<td valign=top><b>v_dlightcshift</b></td>
<td valign="top">Включает/выключает изменение цвета экрана при нахождении внутри
&quot;light bubble&quot; при <b>gl_flashblend 1</b>. </td>
</tr>
<tr>
<td valign=top><b>gl_cshiftpercent</b></td>
<td valign="top">Регулирует силу эффектов, изменяющих цвет экрана. По умолчанию
- 100. Допустимый диапазон 0-100.</td>
</tr>
<tr>
<td valign=top><b>gl_flashblend</b></td>
<td valign="top">Значение 2 заменяет динамическое освещение от ракет на светящийся пузырь. При значении 1 заменяются все другие источники света.</td>
</tr>
</tbody>
</table>
<p>
В клиент встроены <b>particle effects</b>.<br>
Переменные <b>gl_part_blobs</b>, <b>gl_part_blood</b>, <b>gl_part_spikes</b>, <b>gl_part_trails</b>, <b>gl_part_gunshots</b>, <b>gl_part_inferno</b>, <b>gl_part_explosions</b>, <b>gl_part_telesplash</b>, <b>gl_part_lavasplash</b> регулируют разные эффекты.
<ul>
<li>Значение 0 - стандартный эффект Quake</li>
<li><b>1</b> - аналогично FQ 0.31</li>
<li><b>2</b> - некий альтернативный вариант</li>
</ul>
Можно задавать все перемееные кучей при помощи команды gl_particles type. Возможные значения type:
<ul>
<li><b>clasic</b> - стандартный эффект Quake</li>
<li><b>fuh</b> - аналогично FuhQuake 0.31</li>
</li><b>old_qmb</b> - аналогично включению переменной gl_qmb_particles ранее (она убрана).</li>
</ul>
Эффекты можно переключать без рестарта карты.
</p>

<h3></h3>
<h3>Настройка звука</h3>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td valign=top><b>snd_reverse</b></td>
<td>Присвоение этой переменной значения 1 позволяет поменять местами правый и
левый канал звука.</td>
</tr>
<tr>
<td valign=top><b>snd_restart</b></td>
<td>Эта команда перезапускает звуковую подсистему. Иногда помогает при проблемах
со звуком.</td>
</tr>
<tr>
<td valign=top nowrap><b>stopsound 1</b></td>
<td>Если задать команде <b>stopsound</b> дополнительный параметр, то она глушит
не все звуки, а только те, что проигрываются командами <b>play</b>, <b>playvol</b>.</td>
</tr>
</tbody>
</table>
<h3>Новые переменные</h3>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td valign=top><b>mapname</b></td>
<td>карта (read-only)</td>
</tr>
<tr>
<td><b>date</b></td>
<td>дата (read-only)</td>
</tr>
<tr>
<td><b>time</b></td>
<td>время (read-only)</td>
</tr>
<tr>
<td valign=top><b>date_format</b></td>
<td>определяет формат вывода даты: 0 - ddmmyyyy (по умолчанию), 1 - ddmm, 2- dd-mm-yyyy,
3 - dd-mm</td>
</tr>
<tr>
<td valign=top><b>time_format</b></td>
<td>определяет формат времени: 0 - hhmmss (по умолчанию), 1 - hhmm, 2- hh-mm-ss,
3 - hh-mm</td>
</tr>
<tr>
<td valign=top><b>cl_currentweapon</b></td>
<td>содержит номер текущего оружия. В TeamFortress во время релоада - 0. Определяется
по имени текущей модели оружия, даже если показ оружия запрещен переменной <b>r_drawviemodel</b>. Отдельные модельки pipe-launcher, v_tgun и v_flame из <a href="http://quake.morda.ru/tf2003/">TF2003</a> распознается и
устанавливает <b>cl_currentweapon</b> в соответствующее значение.</td>
</tr>
<tr>
<td valign=top><b>gl_cachemodels</b></td>
<td>(по умолчанию 0) управляет кэшированием информации о моделях на диске. Поскольку
современные компьютеры делают обработку моделей быстро, то особого смысла в кэшировании
нет. Заодно исчезают проблемы с со сменой моделей и клиентом QuakeForge, где зачем-то
сменили формат информации о моделях, из-за чего другие клиенты просто падают при
загрузке моделей.</td>
</tr>
<tr>
<td valign=top><b>cl_ping</b></td>
<td>Данная переменная содержит текущее значение пинга (то же самое, что показывает
lagmeter).</td>
</tr>
</tbody>
</table>
<h3>Дополнительные ключи в командной строке</h3>
<table width="100%" border="0" cellspacing="0" cellpadding="3">
<tr>
<td valign="top"><b>-mtfl</b></td>
<td>Устанавливает ограничение на <b>gamma</b> соответствии с правилами <a target=_top href="http://mtfl.sd.ru">Московской
TF лиги</a> (не выше 0.55). В GL-версии дополнительно форсируются ключ <b>-gamma
1</b> и <b>vid_hwgammacontrol 1</b> (это нужно для максимального соответствия
эффекта flash-гранаты тому, что есть в soft-версии клиента). Клиент запущенный
с ключем <b>-mtfl</b> добавляет в ответ на <b>f_version</b> символ &quot;+&quot;
(&quot;*&quot; если возникли проблемы с функцией SetDeviceGammaRamp под Win2000/XP).</td>
</tr>
<tr>
<td valign="top"><b>-sgis</b></td>
<td>GL-версия использует по умолчанию ARB-мультитекстурирование. Данный ключ позволяет
форсировать использование SGIS-мультитекстурирования.</td>
</tr>
<tr>
<td valign="top" nowrap><b>-nohwtimer</b></td>
<td>Отключает новый более точный отсчет времени и возвращает старый алгоритм.</td>
</tr>
<tr>
<td valign="top"><b>-zone</b></td>
<td>Увеличен размер по умолчанию до 2 Мегабайт (соответствует <b>-zone 2048</b>)</td>
</tr>
<tr>
<td valign="top"><b>-heapsize</b></td>
<td>Клиент по умолчанию захватывает 32 Мегабайта памяти.</td>
</tr>
<tr>
<td valign="top"><b>-use8bit</b></td>
<td>Включает использование палетизированных текстур в GL версии.</td>
</tr>
<tr>
<td valign="top"><b>-fullscreen</b></td>
<td>Linux-GLX версия пытается запустится в fullscreen режиме</td>
</tr>
<tr>
<td valign="top"><b>-freq V</b></td>
<td>Задает частоту вертикальной развертки монитора в Герцах.</td>
</tr>
</table>
<h3>Лог консоли</h3>
<p>Возможно включать и выключать лог консоли в произвольный момент. Вот переменные
и команды имеющие к этому отношение:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>log_filename</b></td>
<td>если эта переменная непустая, то в файл с именем &lt;gamedir&gt;/&lt;log_filename&gt;
сбрасывается лог консоли.</td>
</tr>
<tr>
<td valign=top><b>log_prefix</b></td>
<td>перед каждой строчкой лога вставляется содержимое данной переменной, причем
производится подстановка переменных в ней. Анализаторы логов сойдут с ума, но
кому сейчас легко? :)</td>
</tr>
<tr>
<td valign=top><b>log_truncate</b></td>
<td>эта команда урезает лог файл до нулевой длины; имя определяется переменной
<b>log_filename</b> </td>
</tr>
</tbody>
</table>
<p>Данный лог файл совершенно не связан с тем, что получается по ключику <b>-condebug</b>.
Можно даже писать два лога - для надежности :)</p>
<p>Примеры:</p>
<p><b>// starts new log with timestamps<br>
log_prefix "[@date @time]"<br>
log_filename "mycoollog.txt"<br>
log_truncate </b></p>
<p><b>// stops logging<br>
log_filename ""</b></p>
<h3>Регулировка числа пакетов посылаемых на сервер</h3>
<p>В движке Quake fps жестко связан с числом пакетов посылаемых на сервер. Таким
образом если у вас плохой канал и маленький <b>rate</b>, то вы не получите хорошего
fps. Переменная <b>cl_c2spps</b> позволяет ограничить число пакетов посылаемых
на сервер. При этом ваш fps определяется переменной <b>cl_maxfps</b>. "Лишние"
пакеты выбрасываются, поэтому побочным эффектом является packetloss, и как следствие
могут не срабатывать какие-нибудь команды. Однако, чтобы важные команды (выстрелы,
прыжки, импульсы) не терялись, были предприняты меры. Но гарантировать ничего
нельзя.</p>
<p>Пример:</p>
<p><b>cl_maxfps 60<br>
cl_c2spps 30</b></p>

<p>Клиент может автомотачиски определять подключение к прокси и подставлять вместо команды connect команду для прокси. Для этого нужно установить переменную <b>cl_useproxy</b> в 1.
Также добавлены команды <b>join</b>, <b>observe</b>, которые устанавливают переменую spectator в 0 и 1 соответственно и делают reconnect (с учетом прокси).</p>

<h3>Изменение алгоритма поиска файлов</h3>
<p>Можно задать gamedir для клиента сразу при старте:</p>
<p><b>qwcl262 -game fortress</b></p>
<p>При этом каталог <b>fortress</b> добавляется в путь поиска, соответственно
файлы находящиеся там имеют приоритет над теми, что лежат в <b>qw</b> и <b>id1</b>.
Это относится помимо прочего к <b>quake.rc</b>, <b>autoexec.cfg</b>, <b>gfx.wad</b>,
<b>conback.lmp</b> и т.д. </p>
<p>Небольшой комментарий, касающийся <b>quake.rc</b>: Дефолтный <b>quake.rc</b>
лежит в <b>id1/pak0.pak</b> и содержит вызов <b>autoexec.cfg</b>, <b>config.cfg</b>
и команду <b>stuffcmds</b>, которая заносит в буфер исполнения команды выданные
в командной строке клиента (например <b>+connect localhost</b>). Если вы решили
написать свой <b>quake.rc</b>, то эти действия,если они вам нужны, вы должны сами
в него вставить. При запуске клиента с ключиком <b>-game</b> и стандартным <b>quake.rc
autoexec.cfg</b> сначала ищется в заданном каталоге, что позволяет автоматически
выполнять конфиг нужного вам мода до коннекта к серверу. </p>
<p>Команда <b>userdir</b> может быть использована для добавления в список каталогов,
просматриваемых клиентом при поиске файлов (конфигов, звуков, моделей etc.) определяемого
пользователем места. Весьма удобна, если на одном компьютере играет несколько
человек с разными конфигами.</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>userdir [dir [type]]</b></td>
<td>
<p>Добавляет каталог в список поиска:<br>
0 (по умолчанию) - &lt;quake_dir&gt;/&lt;gamedir&gt;/&lt;dir&gt;<br>
1 - &lt;quake_dir&gt;/&lt;dir&gt;/&lt;gamedir&gt;<br>
2 - &lt;quake_dir&gt;/qw/&lt;dir&gt;/&lt;gamedir&gt;<br>
3 - &lt;quake_dir&gt;/qw/&lt;dir&gt;<br>
4 - &lt;quake_dir&gt;/&lt;dir&gt;<br>
5 - $HOME/qw/&lt;dir&gt; (где $HOME - содержимое переменной среды HOME)</p>
<p>Если выдать эту команду после коннекта к серверу или не указать каталог, то
выдается текущий userdir.</p>
</td>
</tr>
</tbody>
</table>
<p>Можно задать <b>userdir</b> сразу при старте клиента. При этом стартовые конфиги
будут исполняться с учетом этого. Можно использовать <b>-userdir</b> и <b>-game</b>
как вместе, так и по раздельности. Пример:</p>
<p><b>qwcl262 -userdir vasya 2 -game fortress</b></p>
<p>Возможно использование PAK-файлов с произвольными именами. При подключении
каталога в путь поиска сначала идет поиск файлов <b>pak0.pak, pak1.pak</b>, затем
читается из этого каталога файл <b>pak.lst</b> и грузятся паки, перечисленные
в нем (по одному на строке, с расширением). При этом GL-версия пропускает файлы,
начинающиеся на <b>&quot;soft&quot;</b>, а soft-версия пропускает файлы, начинающиеся
на <b>&quot;gl&quot;</b>. Если установлен <b>userdir name</b>, то в последнюю
очередь делается попытка загрузить <b>name.pak</b>. <br>
</p>
<h3>Запись и проигрывание демок</h3>
<p>В клиент встроен демо-плеер. До него можно добраться через меню (<b>multipayer-demos</b>)
или командой <b>menu_demos</b>. Работает поиск по первой букве названия демки. Возможно проигрывание демок в формате <b>qwd,
qwz</b> (компрессированный формат <b>qizmo proxy</b>) и <b>mvd</b> (multi view
demo, серверные демки). <b>qwz</b>-демки предварительно распаковываются при помощи
<b>qizmo</b>, распакованный файл стирается по окончании просмотра. Переменная
<b>qizmo_dir</b> (по умолчанию <b>&quot;qizmo&quot;</b>) определяет расположение
каталога, где находится <b>qizmo</b>, относительно каталога <b>quake</b>. </p>
<p>Запись демки в отличие от стандартного клиента 2.30 не приводит к автоматическому
отключению дельта-компрессии, что уменьшает лаги. Во время просмотра демки можно
использовать команду <b>pause.</b></p>
<p>Начало проигрывания демки задерживается до того момента, когда ее действительно
можно показывать. Помогает, когда что-то интересное находится близко к началу
демки</p>
<p>Улучшено проигрывание демок, записанных спектатором с <b>cl_chasecam 1</b>.
Моделька игрока не показывается, но зато видно оружие.</p>
<p>Для удобвства демки записываются в gamedir/demos/</p>

<p>Команды:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>demo_jump [+][min:]sec</b></td>
<td>Позволяет быстро проматывать демку на заданное место. Назад мотать нельзя! Примеры:
<pre>// перемотать на отметку 25 минут 30 секунд от начала демки
demo_jump 25:30
// перемотать на 3 минуты вперед
demo_jump +3:00
// перемотать на 30 секунд вперед
demo_jump +30</pre>
</td>
</tr>
<tr>
<td valign=top><b>demo_setspeed speed</b></td>
<td>позволяет менять скорость демки. speed задается в процентах. 100% - нормальная скорость. Также <b>demo_setspeed</b> понимает относительное изменение скорости.
Пример:
<pre>
// увеличение скорости на 50%
demo_setspeed +50
// уменьшение скорости на 20%
demo_setspeed -20
</pre>
</td>
</tr></table>
<p>Переменные, имеющие отношение к демкам:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>cl_demoflushtime</b></td>
<td> Отвечает за интервал сброса буфера при записи демки. По умолчанию 5, (значение
0 возвращает старое поведение). Это сделано во избежании слишком частого обращения
к диску, что может привести к незначительным тормозам. </td>
</tr>
<tr>
<td valign=top><b>cl_fovtodemo</b></td>
<td>если эта переменная не равна 0 (по умолчанию 1), то в демку запишется изменение
<b>fov</b> в процессе игры.</td>
</tr>
<tr>
<td valign=top><b>cl_fovfromdemo</b> </td>
<td>если эта переменная равна 0 (по умолчанию 1), то при проигрывании демки игнорируются
записанные в ней команды <b>fov</b></td>
</tr>
<tr>
<td valign=top><b>demotimescale</b></td>
<td>задает скорость проигрывания демки. Возможно как ускоренное (&gt;1), так и
замедленное воспроизведение. Может изменяться в диапазоне от 0 до 20 включительно. Значение 0 эквивалентно паузе.</td>
</tr>
<tr>
<td valign=top><b>cl_democlock</b></td>
<td>Если она установлена в 1 (по умолчанию), то при проигрывании демки в левом нижнем углу показывается время прошедшее от начала демки. Если значение переменной равно 2, то показывается 
то время, которое записано в демке, а не от начала демки.</td>
</tr>
<tr>
<td valign=top><b>cl_demoplay_restrictions</b></td>
<td>если присвоить этой переменной 0 (по умолчанию 1), то при проигрывании демок
можно биндить все кнопки и показывать hud</td>
</tr>
<tr>
<td valign=top><b>cl_demoplay_flash</b> </td>
<td>уменьшает эффект от flash-гранаты при просмотре демок (по умолчанию 1). Значение
0.7 вполне подходит для просмотра демок типа демомана на входе мускрата :) </td>
</tr>
<tr>
<td valign=top><b>cl_demoplayer_sort</b></td>
<td>определяет режим сортировки файлов в демо-плеере. 0 - по имени (default),
1 - по размеру. </td>
</tr>
</tbody>
</table>
<h3>Режим спектатора и просмотр MVD демок</h3>
<p>Улучшен режим спектатора. Просмотр <b>mvd</b> демки практически не отличается
от спектатора, с той разницей, что можно поставить демку на паузу в интересном
моменте и переключится на нужного игрока или переместить камеру. При переключении
точки зрения в <b>mvd</b> демках происходит сброс эффектов concussion и flash
гранат.</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>cl_spec_id</b></td>
<td>Если эта переменная равна 1 (по умолчанию), то показывается ник игрока на
которого смотришь и по +attack камера цепляется на игрока последним пробегавшего
под прицелом.<br>
При значении 2 над каждым игроком в поле зрения выводится его имя.<br>
При значении 3 дополнительно к имени выводится здоровье и армор.</td>
</tr>
<tr>
<td><b>track (id | uid)</b></td>
<td>по этой команде камера переключается на указанного игрока</td>
</tr>
<tr>
<td valign=top><b>cl_spectator_restrictions</b></td>
<td>если присвоить этой переменной 0 (по умолчанию 1), то при в режиме спектатора
показывается hud и работают триггеры</td>
</tr>
</tbody>
</table>
<h3>Конвертация демок в AVI</h3>
<p>Для облегчения этого процесса введена команда <b>capture</b>. Если при проигрывании
демки дать команду <b>capture &lt;fps&gt;</b>, то клиент начинает автоматически
делать серию скриншотов с указанным fps. Выключается этот режим командой <b>capture
0</b> или автоматически, при окончании демки. Беспокоится о том, успеет ли ваша
машина записать это все на диск, <b>НЕ НАДО</b>. Маньяки могут писать 72 fps в
разрешении 1600x1200. Естественно, демка будет при этом проигрываться медленнее.
И наоборот, если вы делаете 5 кадров в секунду в разрешении 320x200, то это будет
очень быстро :) Скриншоты сладываются в каталог, задаваемый переменной <b>capture_dir</b>
(относительно каталога Quake, default: &quot;capture&quot;). Там создается подкаталог
с именем @date-@time во избежание случайного затирания одной серией скриншотов
другой.</p>
<h3>Mini-Gamespy</h3>
<p>Можно узнать некоторую информацию о сервере без коннекта к нему.</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>gamespy server:port</b></td>
<td>По этой команде можно узнать, сколько игроков на сервере и какая карта стоит</td>
</tr>
<tr>
<td><b>cl_gamespy_showplayers</b></td>
<td>если эта переменная равна 1 (по умолчанию 0), то <b>gamespy</b> также показывает
информацию об игроках</td>
</tr>
<tr>
<td valign=top noWrap><b>cl_gamespy_showrules</b></td>
<td>Если установить ее в 1 (по умолчанию 0), то <b>gamespy</b> показывает serverinfo.</td>
</tr>
</tbody>
</table>
<p>Пример:<br>
<b>cl_gamespy_showplayers 1<br>
gamespy quake.orc.ru:27530</b></p>
<h3>Ограничение возможностей клиента при помощи serverinfo fpd</h3>
<p>Клиент понимает некоторые ограничения выставляемые администратором сервера
в serverinfo fpd и отключает некоторые функции. Поддерживаются такие биты в fpd:</p>
<ul>
<li>1 - Запрещаются макросы в say</li>
<li>2 - Запрещается определение времени с точностью до секунды </li>
<li>4 - Запрещаются триггеры</li>
</ul>
<p>При коннекте к серверу клиент сообщает в консоли, что именно отключено.</p>
<a name=filter></a>
<h2>Фильтрация сообщений</h2>
<p>Имеется возможность фильтровать сообщения на клиентской стороне (работает с
любым сервером, но сервер QW262 осуществляет фильтрацию сам, уменьшая сетевой
траффик). Чтобы сообщение фильтровалось оно должно заканчиваться на <b>#abc</b>,
где abc это имя канала (должно состоять из 3 букв!). Сообщения без имени канала
никогда не фильтруются. Можно задавать фильтрацию по нескольким каналам. Команда
<b>filter "#att#eng"</b> позволит вам получать сообщения по каналам <b>#att</b>
и <b>#eng</b>. На данный момент общеупотребительными являются только каналы <b>#att</b>
и <b>#def</b> для атаки и защиты соответственно. При активном фильтре <b>#def</b>,
вы не увидите сообщений, помеченных иначе чем <b>#def</b>. Чтобы отменить фильтрацию
совсем используйте команду <b>filter ""</b>.</p>
<h2>Улучшенная консоль</h2>
<p>В консоли работают следующие клавиши:</p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td valign=top>TAB</td>
<td>tab-completion, повторное нажатие на TAB позволяет перебирать альтернативные
варианты, если их несколько. Работает в любом месте строки</td>
</tr>
<tr>
<td>SHIFT+TAB</td>
<td>Прокручивает альтернативы в обратном порядке. </td>
</tr>
<tr>
<td>HOME</td>
<td>переход в начало строки, если строка ввода не пуста. Иначе переход в начало
буфера консоли</td>
</tr>
<tr>
<td>END</td>
<td>переход в конец строки, если строка ввода не пуста. Иначе переход в конец
буфера консоли</td>
</tr>
<tr>
<td noWrap>LEFTARROW</td>
<td>на символ влево</td>
</tr>
<tr>
<td noWrap>RIGHTARROW</td>
<td>на символ вправо</td>
</tr>
<tr>
<td noWrap>CTRL-LEFTARROW</td>
<td>на слово влево</td>
</tr>
<tr>
<td noWrap>CTRL-RIGHTARROW</td>
<td>на слово вправо</td>
</tr>
<tr>
<td>CTRL-HOME</td>
<td>в начало буфера консоли</td>
</tr>
<tr>
<td>CTRL-END</td>
<td>в конец буфера консоли</td>
</tr>
<tr>
<td>CTRL-ENTER</td>
<td>посылает сообщение по say_team</td>
</tr>
<tr>
<td>DEL</td>
<td>убивает символ под курсором</td>
</tr>
<tr>
<td>BACKSPACE</td>
<td>убивает символ слева от курсора</td>
</tr>
<tr>
<td noWrap>ALT-(буква или цифра)</td>
<td>ввод коричневых букв и цифр</td>
</tr>
<tr>
<td noWrap>CTRL-цифра</td>
<td>ввод желтых цифр</td>
</tr>
<tr>
<td noWrap>CTRL-(R,G,B,Y)</td>
<td>ввод "лампочек" из <a
href="#ocrana">ocrana.pak</a></td>
</tr>
<tr>
<td noWrap>CTRL-([,])</td>
<td>ввод цветных скобок</td>
</tr>
<tr>
<td>CTRL-V</td>
<td>В Win32 версии вставляет в консоль содержимое clipboard</td>
</tr>
</tbody>
</table>
<p>В режиме <b>messagemode</b>, <b>messagemode2</b>, <b>messagemode3</b> имеется
буфер предыдущих сообщений, который может прокручиваться кнопками UPARROW и DOWNARROW.
</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>cl_completion_sort </b></td>
<td>Если установить ее в 0 (по умолчанию 1), то при нажатии TAB варианты идут
не по алфавиту, а сначала выдаются команды.</td>
</tr>
<tr>
<td valign=top><b>cl_chatmode</b></td>
<td>Определяет что делать с текстом, набираемым в консоли. При значении 0, все
рассматривается как команды, при значении 1 - все идет на сервер по команде <b>say</b>,
при значении 2 (default) сначала производится проверка и если набрана команда,
то она выполняется, если нет - отправляется по <b>say</b> на сервер</td>
</tr>
</tbody>
</table>
<p>В консоли блокируются -alias'ы, чтобы они не выполнялись при нажатии на клавиши.
Исключение составляют кнопки, не имеющие функции в консоли (вроде Fx).</p>
<h2>Клавиши</h2>
<p>Расширен набор клавиш на которые можно что-то забиндить. Можно биндить CAPSLOCK,
SCROLLCK, NUMLOCK, PRINTSCR. Если переменная <b>cl_keypad</b> равна 1, то можно
биндить кнопки расширенной клавиатуры независимо, то есть кнопка DEL будет отличаться
от KP_DEL. Названия кнопок показаны ниже. Некоторые кнопки имеют несколько альтернативных
названий, использовать можно любое из них.</p>

<p>Улучшена обработка клавиатуры. Переменная <b>sys_disablewinkeys</b>
в Win32 версии позволяет отключить стандартную реакцию на WinKey (не работает в Win9x).
Возможно биндить RWINKEY, LWINKEY, WINKEY (обе Win-кнопки разом), POPUPMENU.
Возможно биндить отдельно правые и левые варианты SHIFT, CTRL, ALT
(LSHIFT, RSHIFT, LALT, RALT, RCTRL, LCTRL).
</p>

<table cellspacing=0 cellpadding=5 width="50%" align=center border=1>
<tbody>
<tr>
<td height=50>NUMLOCK, KP_NUMLCK, KP_NUMLOCK</td>
<td height=50>KP_SLASH, KP_DIVIDE</td>
<td height=50>KP_STAR, KP_MULTIPLY,<br>
* </td>
<td height=50>KP_MINUS</td>
</tr>
<tr>
<td height=50>KP_HOME, KP_7</td>
<td height=50>KP_UPARROW, KP_8</td>
<td height=50>KP_PGUP, KP_9</td>
<td height=50 rowspan=2>KP_PLUS</td>
</tr>
<tr>
<td height=50>KP_LEFTARROW, KP_4</td>
<td height=50>KP_5</td>
<td height=50>KP_RIGHTARROW, KP_6</td>
</tr>
<tr>
<td height=50>KP_END, KP_1</td>
<td height=50>KP_DOWNARROW, KP_2</td>
<td height=50>KP_PGDN, KP_3</td>
<td height=50 rowspan=2>KP_ENTER</td>
</tr>
<tr>
<td colspan=2 height=50>KP_INS, KP_0</td>
<td height=50>KP_DEL, KP_DOT</td>
</tr>
</tbody>
</table>
<p>Примечания:</p>
<p>В Win32 версии кнопка PRINTSCR не срабатывает, если одновременно нажаты CTRL,
ALT etc. </p>
<h2>Мышь</h2>
<p>В режиме DirectInput работает колесо на мыши если переменная <b>m_forcemwheel</b>
установлена в 1.</p>
<p>Поддерживаются кнопки MOUSE4 - MOUSE8. Однако для этого нужна поддержка в драйвере
мыши. <i>Работает</i> с драйверами от Microsoft, и Logitech Mouseware. Для этого необходима библиотека mhooks.dll (идет в комплекте).</p>
Выбор мыши осуществляется командой <b>m_hook (0|ip|mw)</b>.
<ul>
<li><b>0</b> - снимает хук</li>
<li><b>ip</b> - поддержка кнопок MS IntelliPoint. В этом случае поддерживаются Tilt Wheel на MS IntelliMouse Explorer 4. Можно биндить TWHEELRIGHT и TWHEELLEFT</li>
<li><b>mw</b> - поддержка MouseWare</li>
</ul>

Совершенно не важно, что именно назначено для 4-8 кнопок мыши в Mouseware. Если вас не устраивает
нумерация кнопок мыши получаемая по умолчанию, возможно переопределить их используя
команду <b>m_map_button</b>:</p>
<p>Пример: логически меняем местами 4ую и 5ую кнопки мыши, а 6ая становится эквивалентна
кнопке 'a' :<br>
<b>m_map_button 4 MOUSE5<br>
m_map_button 5 MOUSE4<br>
m_map_button 6 a</b></p>
<p></p>

<p>Возможно использовать все кнопки эмулируемые Logitech Mouseware при нажатии
на кнопки мыши, а не только CTRL и SHIFT. Однако следует иметь в виду:</p>
<ol>
<li>Использование <b>m_hook mw</b> гораздо удобнее.</li>
<li>Команды о нажатии и отпускании кнопки приходят одна за другой без паузы, так
что может потребоваться <b>wait</b>. </li>
<li>Они приходят не при нажатии соответствующей кнопки мыши, а при ее ОТПУСКАНИИ.</li>
<li>Если у вас <b>cl_keypad 1</b> то генерируются KP_* варианты кнопок для PGDN,
PGUP etc. </li>
</ol>
<p>
Переменная <b>sys_yieldcpu</b>. Установка в 1 избавляет от "замерзания" мыши в WinXP при использовании MouseWare.
</p>

<a
name=script></a>
<h2>Улучшенные скрипты</h2>
<p>Значительно ускорено выполнение алиасов (по сравнению с 2.30). Расширен язык
скриптов. Буфер для обработки команд увеличен до 16K. При старте клиента после
загрузки quake.rc выполняется алиас <b>262_quakerc</b>, а при смене <b>gamedir</b>
после обычных конфигов выполняется алиас <b>262_autoexec</b>. Таким образом можно
выделить специфическую для QW262 часть конфига, чтобы не получать кучу сообщений
об ошибках при запуске стандартного клиента, не понимающего расширений QW262.</p>
<h3>Определяемые пользователем переменные (cvar)</h3>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>register cvar_name1 [cvar_name2...]</b></td>
<td valign=top>Регистрирует для дальнейшего использования одну или несколько переменных</td>
</tr>
<tr>
<td valign=top noWrap><b>unregister cvar_name1 [cvar_name2...]</b></td>
<td valign=top>Удаляет ненужные переменные. Встроенные переменные удалить не получится.</td>
</tr>
<tr>
<td valign=top noWrap><b>cl_prefixchar</b></td>
<td valign=top>Задает символ, который имеет специальное значение при подстановке
переменных, операциях инкремента/декремента etc. Допустимы значения <b>@</b> (default)
и <b>$</b> (режим совместимости с ZQuake). </td>
</tr>
</tbody>
</table>
<p>Значения переменных (как встроенных, так и определяемых пользователем) могут
использоваться в скриптах. Перед именем переменной должен стоять знак <b>@</b>
(или <b>$</b>, если вы изменили <b>cl_prefixchar</b>). Подстановка не производится
внутри двойных кавычек за исключением специально оговоренных случаев.<br>
</p>
<p>Примеры:</p>
<p><b>echo current fov: @fov<br>
register class style<br>
class medic<br>
style att<br>
bind t "say_team (@style-@class) Idu po kiwke"</b></p>
<p><i>А также следует помнить одну очень важную вещь, что подстановка переменных
происходит только до конца строки или точки с запятой и если вам требуется создать
переменную с наличием в ней (;), то для этого придется заменить ее переменной,
например:</i></p>
<p><b>set _tz &quot;;&quot;<br>
alias example &quot;set tmp a%a,%h@_tzlocation:%l'&quot;<br>
say_team @tmp</b></p>
<p>Можно увеличивать/уменьшать значение переменной следующим образом:<br>
<b>fov @+5</b> - увеличивает fov на 5<br>
<b>fov @-5</b> - уменьшает fov на 5</p>
<p>Для изменения значений переменных также имеются следующие команды:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>set cvar_name value</b></td>
<td valign=top>присваивает переменной значение</td>
</tr>
<tr>
<td valign=top noWrap><b>set_ex cvar_name value</b></td>
<td valign=top>присваивает переменной значение, причем в value производится подстановка
%макросов и переменных даже в том случае, если параметр заключен в двойные кавычки.</td>
</tr>
<tr>
<td valign=top noWrap><b>set_bind_str cvar_name key_name</b></td>
<td valign=top>присваивает переменной то, что забиндено на указанную клавишу.</td>
</tr>
<tr>
<td valign=top noWrap><b>set_alias_str cvar_name alias_name</b></td>
<td valign=top>присваивает переменной содержимое указанного алиаса</td>
</tr>
<tr>
<td valign=top noWrap><b>set_calc &lt;cvar&gt; &lt;expr1&gt; &lt;op&gt; &lt;expr2&gt;</b></td>
<td valign=top>
<p>позволяет делать некоторые элементарные вычисления в скриптах. Результат заносится
в переменную <b>&lt;cvar&gt;</b>. <b>&lt;expr1&gt;</b> - <b>&lt;expr2&gt;</b>
- числа. Поддерживаются несколько арифметических операций:</p>
<ul>
<li>+ - сложить</li>
<li>- - вычесть</li>
<li><b>*</b> - умножить</li>
<li><b>/ </b>- разделить</li>
<li><b>%</b> - остаток от целочисленного деления</li>
<li><b>div</b> - целочисленное деление</li>
<li><b>or</b> - побитное или</li>
<li><b>and</b> - побитное и</li>
<li><b>xor</b> - побитное исключающее или</li>
<li><b>int</b> - отбрасывание дробной части</li>
</ul>
<p>Дополнительно, для работ со строками:<br>
<b>set_calc &lt;cvar&gt; strlen &lt;строка&gt;</b> - вычислить длину строки и
результат поместить в <b>&lt;cvar&gt;</b>;<br>
<b>set_calc &lt;cvar&gt; substr &lt;cvar2&gt; &lt;pos&gt; [&lt;len&gt;]</b> -
вырезает из строкового значения переменной <b>&lt;cvar2&gt;</b> кусок с позиции
<b>&lt;pos&gt;</b> (строка начинается с 0!) и длиной <b>&lt;len&gt;</b> и присваивает
это значение переменной <b>&lt;cvar&gt;</b>, если <b>&lt;len&gt;</b> не задан
подразумевается 1;<br>
<b>set_calc &lt;cvar&gt; pos &lt;cvar2&gt; &lt;string&gt;</b> - ищет в переменной
<b>&lt;cvar2&gt;</b> строку <b>&lt;string&gt;</b> и присвает номер позиции переменной
<b>&lt;cvar&gt;</b>, если строка не найдена присваивается -1.<br>
<b>set_calc &lt;array&gt; set_substr &lt;var&gt; &lt;pos&gt; - </b>записывает
содержимое переменной <b>&lt;var&gt;</b> в переменную <b>&lt;array&gt;</b> c позиции
<b>&lt;pos&gt;</b>. Если <b>&lt;pos&gt;</b> выходит за длину строкового значения
переменной <b>&lt;array&gt;</b>, то она дополняется пробелами.<br>
<b>set_calc &lt;cvar&gt; tobrown</b> и<br>
<b>set_calc &lt;cvar&gt; towhite</b> преобразуют значение переменной к цветным/белым
буквам соответственно.</p>
<p>Важное дополнение:<br>
Строки начинающееся с '+' и '-' распознается клиентом как число.
</p>

</td>
</tr>
<tr>
<td valign=top noWrap><b>set_regexp &lt;cvar&gt; [value]</b> </td>
<td valign=top>Создает в переменной <b>&lt;cvar&gt;</b> regexp соответствующий
<b>value</b> (все специальные символы искейпятся). Если <b>value</b> не задан,
то берется исходное значение переменной <b>&lt;cvar&gt;</b>.</td>
</tr>
<tr>
<td valign=top noWrap><b>cl_autoregister</b></td>
<td valign=top>если эта переменная не 0, то все команды <b>set</b> автоматически
регистрируют переменную, если она еще не существует</td>
</tr>
<tr>
<td valign=top noWrap><b>toggle &lt;cvar&gt;</b></td>
<td valign=top>инвертирует значение переменной (0 -&gt; 1, 1 -&gt; 0)</td>
</tr>
<tr>
<td valign=top noWrap><b>crypt &lt;cvar&gt; &lt;key&gt;</b></td>
<td valign=top> команда crypt &lt;cvar&gt; шифрует или дешифрует переменную cvar.
В качестве ключа используется второй параметр &lt;key&gt;. Ограничения: шифруемая
переменная и ключ должны состоять из символов, находящихся в нижней половине кодовой
таблицы</td>
</tr>
<tr>
<td valign=top noWrap><b>inc &lt;cvar&gt; [&lt;value&gt;]</b></td>
<td valign=top>увеличивает переменную на value (если value не указан, то подразумевается
1)</td>
</tr>
</tbody>
</table>
<p>Примеры:<b><br>
// a = b * 3<br>
set_calc a @b * 3 <br>
// len = strlen(str)<br>
set_calc len strlen @str<br>
// a = 7 div 3 = 2<br>
set_calc a 7 div 3 <br>
// intvar = int(3.67) = 3<br>
set_calc intvar int 3.67<br>
set a &quot;aaaaaaaaaaa&quot;<br>
set b &quot;bb&quot;<br>
set_calc a set_substr b 4<br>
// a = &quot;aaaabbaaaaa&quot;</b></p>
<p></p>
<p><b>// rnd (диапазон)<br>
set tmp @time_format;time_format 0;set_calc rnd_seed @time div 123;time_format
@tmp<br>
alias rnd &quot;set_calc rnd_seed @rnd_seed * 106; inc rnd_seed 1283; set_calc
rnd_seed @rnd_seed % 6075; set_calc rnd_n %1 * @rnd_seed; set_calc rnd_n @rnd_n
div 6075&quot;</b><br>
<b>rnd 40<br>
echo @rnd_n</b></p>
<p><b>// crypt/decrypt<br>
set crypt_key &quot;Crypt algorithm is simple&quot;<br>
set text &quot;Very Secret string!&quot;<br>
echo @text<br>
crypt text @crypt_key<br>
echo @text<br>
crypt text @crypt_key<br>
echo @text</b></p>
<p></p>
<p>Команда <b>cvarlist</b> выводит список всех переменных. Флаги перед именем
переменной имеют следующие значения:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td>*</td>
<td>переменная сохраняется в config.cfg</td>
</tr>
<tr>
<td>u</td>
<td>переменная является частью userinfo</td>
</tr>
<tr>
<td>s</td>
<td>переменная является частью serverinfo</td>
</tr>
</tbody>
</table>
<p>Команда <b>bindlist</b> Выводит список всех назначенных клавиш.</p>
<h3>Алиасы</h3>
<p>Алиасы могут иметь параметры. Вместо комбинаций %1-%9 подставляются параметры
переданные алиасу, вместо %0 подставляется вся строка параметров. Примеры:<br>
<b>alias s &quot;say %0&quot;<br>
s hi all!<br>
alias kick "rcon kick %1"<br>
kick 4327</b></p>
<p>Команды работающие с алиасами:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td noWrap><b>viewalias</b></td>
<td>показывает содержимое одного или нескольких алиасов</td>
</tr>
<tr>
<td noWrap><b>removealiases</b></td>
<td>уничтожает <b>все</b> алиасы. Будьте осторожны :)</td>
</tr>
<tr>
<td noWrap><b>unalias alias_name</b></td>
<td>уничтожает указанный алиас</td>
</tr>
<tr>
<td valign=top noWrap><b>alias alias_name</b></td>
<td>если выдать данную команду вручную в консоли, то будет выдано содержимое алиаса.
В случае если команда выдана скриптом, то алиас станет пустым.</td>
</tr>
<tr>
<td valign=top noWrap><b>alias_in &lt;alias&gt; &lt;cvar&gt; [options]</b></td>
<td>
<p>Позволяет вставить в alias содержимое переменной <b>&lt;cvar&gt;</b>. <b>&lt;options&gt;</b>
представляет из себя битовую маску, определяющую действия. </p>
<ul>
<li>1 - (0 - вставлять с левой стороны, 1 - с правой)
<li>2 - (осуществлять ли предварительную проверку на наличие вставляемой строки
или нет)
<li>4 - (выдавать ли сообщение об ошибке)
<li>8 - (если такого алиаса не существует, то автоматически его создавать)
</ul>
</td>
</tr>
<tr>
<td valign=top noWrap><b>alias_out&lt;alias&gt; &lt;cvar&gt; [options]</b></td>
<td>
<p>Позволяет вырезать из alias'а содержимое переменной <b>&lt;cvar&gt;</b>. <b>&lt;options&gt;</b>
представляет из себя битовую маску, определяющую действия. </p>
<ul>
<li>1 - (вырезать или нет строку из алиаса'а. Т.е. если нашла, то не вырезать
<li>2 - не выдавать сообщение, если строка не найдена
</ul>
</td>
</tr>
<tr>
<td valign=top noWrap><b>cvar_in &lt;cvar1&gt; &lt;cvar2&gt; [options]</b></td>
<td>
<p>Позволяет вставить в переменную <b>&lt;cvar1&gt; </b>содержимое переменной
<b>&lt;cvar2&gt;</b>. <b>&lt;options&gt;</b> представляет из себя битовую маску,
определяющую действия. </p>
<ul>
<li>1 - (0 - вставлять с левой стороны, 1 - справой)
<li>2 - (осуществлять ли предварительную проверку на наличие вставляемойстроки
или нет)
<li>4 - (выдавать ли сообщение об ошибке)
<li>8 - (если такой переменной не существует, то автоматически еесоздавать)
</ul>
</td>
</tr>
<tr>
<td valign=top noWrap><b>cvar_out &lt;cvar1&gt; &lt;cvar2&gt; [options]</b></td>
<td>
<p>Позволяет вырезать из переменной <b>&lt;cvar1&gt; </b> содержимое переменной
<b>&lt;cvar2&gt;</b>. <b>&lt;options&gt;</b> представляет из себя битовую маску,
определяющую действия. </p>
<ul>
<li>1 - (вырезать или нет строку из <b>&lt;cvar1&gt;</b>. Т.е. если нашла, то
не вырезать
<li>2 - не выдавать сообщение, если строка не найдена
</ul>
</td>
</tr>
</tbody>
</table>
<h3>Написание сложных алиасов</h3>
<p>Можно писать многострочные алиасы. Если последним символом в строке является
\ , то следующая строка является продолжением предыдущей. Однако не стоит забывать,
что длина одной интерпретируемой строки не должна превышать 1024 символа. </p>
<p>Иногда требуется использовать кавычки внутри кавычек, например когда сложные
алиасы создают другие алиасы. Для облегчения данного процесса введены переменные:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>cl_substsinglequote</b></td>
<td>Если эта переменная не равна 0, то одинарная кавычка будет меняться на двойную.
Две одинарные кавычки подряд заменяются на одну (если подстановка разрешена).
Замена кавычек производится при любом выполнении команд, когда кавычка не находится
внутри двойных кавычек. При этом стоит помнить, что клиент при разборе строки
скрипта принимает строку в двойных кавычках как один параметр, но при исполнении
эти кавычки убираются (надеюсь, что понятно объяснил :)). Не рекомендуется к применению,
используйте <b>cl_stringescape</b> и <b>cl_curlybraces</b></td>
</tr>
<tr>
<td><b>cl_stringescape</b></td>
<td>Если эта переменная не равна 0, то комбинация \" внутри двойных кавычек при
разборе строки заменяется на "</td>
</tr>
<tr>
<td><b>cl_curlybraces</b></td>
<td>Если эта переменная не равна 0, то символы { и } могут использоваться аналогично
\&quot;, с той разницей, что вложенные скобки корректно обрабатываются.</td>
</tr>
</tbody>
</table>
<p>Примеры:<br>
// алиас для автоматического сообщения о месте потери флага<br>
<b>cl_substsinglequote 1<br>
register v_flagdeath<br>
v_flagdeath "say_team ENEMY FLAG: %d; alias f_death"<br>
alias f_took "say_team I''ve got a flag!; alias f_death '@v_flagdeath'"<br>
<br>
cl_substsinglequote 0<br>
cl_stringescape 1<br>
alias f_took "say_team I've got a flag!; alias f_death \"say_team ENEMY FLAG:
%d; alias f_death\"" <br>
</b></p>
<p>Обратите внимание, что эти два способа работают слегка по разному, из-за чего
в первом случае приходится вводить лишнюю переменную.</p>
<p><b>cl_curlybraces 1<br>
if {%1} == {@name} {if @tmp = 1 {alias eee {say ok; say ok2}}\<br>
else {say tmp is not 1}} </b></p>
<h3>Условное выполнение команд</h3>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tr>
<td valign=top noWrap><b>if &lt;expr1&gt; &lt;op&gt; &lt;expr2&gt;<br>
[then] command1 [else command2]</b></td>
<td>Знакомая всем конструкция <b>if/then/else</b>:
<p><b>&lt;expr1&gt;</b> и <b>&lt;expr2&gt;</b> - сравниваемые строки (или числа)<br>
<b>&lt;op&gt;</b> - операнд, один из:</p>
<ul>
<li><b>==</b> - равно,</li>
<li><b>=</b> - равно,</li>
<li><b>!=</b> - не равно,</li>
<li><b>&lt;&gt;</b> - не равно,</li>
<li><b>&gt;</b> - больше,</li>
<li><b>&lt;</b> - меньше,</li>
<li><b>&gt;=</b> - больше, либо равно,</li>
<li><b>&lt;=</b> - меньше, либо равно,</li>
<li><b>=~</b> - epxr1 подходит под регулярное выражение expr2,</li>
<li><b>!~</b> - epxr1 <b>не</b> подходит под регулярное выражение expr2;</li>
</ul>
<p>(<b>==</b> и <b>=</b>, <b>!=</b> и <b>&lt;&gt;</b> означают одно и то же, пишите,
как больше нравится.)</p>
<p><b>then</b> писать не обязательно, ну и <b>command2</b> тоже (если <b>command2</b>
присутствует, то <b>else</b> должно быть обязательно!).</p>
</td>
</tr>
<tbody>
<tr>
<td valign=top noWrap><b>if_exists &lt;type&gt; &lt;name&gt; <br>
&lt;cmd1&gt; [&lt;cmd2&gt;]</b></td>
<td>
<p>Если объект указанного типа <b>&lt;type&gt;</b> с именем <b>&lt;name&gt;</b>
существует, то выполнится <b>&lt;cmd1&gt;</b>, а если нет, то <b>&lt;cmd2&gt;</b>.<br>
Тип объекта может иметь значения: <b>cvar, alias, trigger</b> или <b>hud.</b>
</td>
</tr>
</tbody>
</table>
<p>Примеры:</p>
<p><b>register v_reportdeath<br>
v_reportdeath 1</b><b><br>
alias f_death &quot;if @v_reportdeath = 1 then say_team I am dead [%d]"</b><br>
</p>
<p><b>cl_substsinglequote</b> 1<br>
<b>set _tz &quot;;&quot;</b><br>
<b>if_exists alias f_death &quot;set_alias_str tmp f_death;alias f_death 'play
dead.wav@_tz@tmp'&quot; &quot;alias f_death 'play dead.wav'&quot;</b></p>
<a name=macros></a>
<h2>Макросы для сообщений</h2>
<p>В случае, если значение переменной <b>cl_parsesay</b> не равно 0, то в командах
<b>say*</b>,<b> echo </b>и<b> set_ex</b> производится подстановка макросов (даже
внутри двойных кавычек).</p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td>макрос</td>
<td>подставляется</td>
</tr>
<tr>
<td><b>%a</b></td>
<td>армор</td>
</tr>
<tr>
<td><b>%t</b></td>
<td>тип армора (green, yellow, red)</td>
</tr>
<tr>
<td><b>%h</b></td>
<td>здоровье</td>
</tr>
<tr>
<td><b>%p</b></td>
<td>powerup, если от у вас есть :) (quad, 666, eyes)</td>
</tr>
<tr>
<td><b>%s</b></td>
<td>количество shells</td>
</tr>
<tr>
<td>
<p><b>%n</b></p>
</td>
<td>количество nails</td>
</tr>
<tr>
<td><b>%r</b></td>
<td>количество rockets</td>
</tr>
<tr>
<td><b>%c</b></td>
<td>количество сells</td>
</tr>
<tr>
<td><b>%l</b></td>
<td>ваше текущее положение на карте (требуется загруженный <a
href="#locfile">loc-файл</a>).</td>
</tr>
<tr>
<td><b>%L</b></td>
<td>выводит текущую позицию, или место последней смерти (если вас убили меньше
5 секунд назад)</td>
</tr>
<tr>
<td><b>%d</b></td>
<td>место последней смерти (требуется загруженный loc-файл)</td>
</tr>
<tr>
<td><b>%p</b></td>
<td>показывает флаг в TF. Например: say_team "%p" скажет flag.</td>
</tr>
<tr>
<td><b>@<font color="#FF0000">R</font></b></td>
<td>красная "лампочка" из <a href="#ocrana">ocrana.pak</a></td>
</tr>
<tr>
<td><b>@<font color="#00FF00">G</font></b></td>
<td>зеленая "лампочка" из ocrana.pak</td>
</tr>
<tr>
<td><b>@<font color="#0000FF">B</font></b></td>
<td>синяя "лампочка" из ocrana.pak</td>
</tr>
<tr>
<td><b>@<font color="#FFFF00">Y</font></b></td>
<td>желтая "лампочка" из ocrana.pak</td>
</tr>
<tr>
<td><b>@[ и @]</b></td>
<td>цветные скобки</td>
</tr>
<tr>
<td><b>@:</b></td>
<td>переход на другую строку (возврат каретки)</td>
</tr>
<tr>
<td><b>@\</b></td>
<td>создание fake-сообщений (работает только в say_team и say_to_team)</td>
</tr>
</tbody>
</table>
<p>В макросах используется символ <b>@</b> или <b>$</b>, в зависимости от значения
<b>cl_prefixchar</b>.</p>
<p>Введены макросы, которые подставляются наравне с переменными. Список макросов
выдается командой <b>macrolist</b>.</p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tr>
<td  valign=top><b>cl_locmessage</b></td>
<td> Если 0 (по умолчанию 1), тогда можно передавать членам команды свое положение
на карте в виде координат. Макросы %l, %d, %L выдают не строку из loc-файла, а
координаты точки. Эти координаты можно отлавливать самостоятельно и подсовывать
команде <b>loc_coords2loc var x y z</b>, которая по координатам <b>x</b>, <b>y</b>,
<b>z</b> найдет строку в loc-файле и подставит в переменную <b>var</b>. Если вас
такой путь не радует, то установите переменную <b>cl_coords2loc</b> и координаты
будут преобразовываться в строки автоматически. То есть вам приходит по <b>say_team</b>
строка <b>&quot;(Vasya): I'm at [1345 -567 776]&quot;</b>, а вы видите в консоли
<b>&quot;(Vasya): I'm at enemy FR&quot;</b>. </td>
</tr>
<tr>
<td  valign=top><b>cl_digits_format </b></td>
<td>Если ее установить в 1 (по умолчанию 0), то %-макросы будут выдавать не желтые
цифры, а обычные.</td>
</tr>
<tr>
<td  valign=top><b>cl_parseWhiteText</b></td>
<td>При значении 1 (по умолчанию 0), текст внутри сообщений, заключенный в фигурные скобки <b>{}</b>, рисуется белым цветом.</td>
</tr>
<tr>
<td  valign=top><b>cl_nofake</b></td>
<td>Управляет отображением fake-сообщений. Эти сообщения содержат символ 0x0D,
что позволяет скрыть имя отправителя при показе на экране (в лог все пишется).
При значении 1 (по умолчанию), fake-сообщения запрещены, данный символ заменяется
на # и сообщение нормально показывается вместе с именем отправителя. При значении
2, fake-сообщения разрешены только в say_team, say_to_team. 0 разрешает любые
fake-сообщения.</td>
</tr>
</table>
<p>Для макросов количества боеприпасов есть более хитрые варианты: <b>%c+130</b>
- количество cells, которого вам не хватает до 130; <b>%c-130</b> - количество
сеlls, которые у вас есть сверх 130.</p>
<p>Примеры:<br>
<b>say_team "@GI'm at position, clear (%a:%h)#def"<br>
say_team "@RHelp to defend flag [%l]"<br>
say_team "@REnemy flag dropped [%d]"<br>
say_team "Need rockets, have only %r"<br>
say_team "Need %c+130 cells to build/upgrade sentrygun!"<br>
say_team &quot;@\@RFULL DEFENCE!@R@:Really :)&quot;<br>
// для hunted и сервера 262<br>
say_to_team red &quot;@\PRESIDENT: Сlean the respawn area!&quot;</b></p>
<a name=ocrana></a>
<h3>Ocrana pak</h3>
<p>Этот пак модифицирует шрифт используемый в консоли. На месте 4х неиспользуемых
символов с кодами 0x86-0x89 показываются яркие, хорошо заметные "лампочки". Их
удобно использовать для выделения важных сообщений. Однако не стоит ими злоупотреблять,
сообщения должны быть действительно важные.</p>
<p>В клиенте реализован учет траффика. Входящий и исходящий траффик доступны через макросы <b>@net_in</b>, <b>@net_out</b><br>
Для экономящих свой траффик будет полезен вот такой скриптик:<br>
re_trigger _stop_gaming ".*"
alias _stop_gaming "if @net_in >= 25 then _stop_gaming2" // если входящий траффик больше 25мб, заканчиваем игру
alias _stop_gaming2 "echo @R no enough money for playing so long. :);disconnect"
</p>
<p>Команда <b>net_reset</b> сбрасывает счетчики сетевого траффика.</p>
<p>В клиент добавлены дополнительные переменные <b>cl_blueteam</b>, <b>cl_redteam</b>, <b>cl_yellowteam</b>, <b>cl_greenteam</b>.
Они содержат названия соответствующих команд в TF и их можно использовать в loc-файлах. Их можно определять самому, пример:<br>
<pre>cl_blueteam enemy
cl_redteam our
</pre>
В локах @red, @blue, @yell, @green подставляются как макросы.
Теперь если у нас в локах местоположение описано, например, так: "@red spirale, up.", то @red будет заменяться на "our", что в игре более понятно.</p>

<a name=locfile></a>
<h2>Поддержка loc-файлов</h2>
<p>loc-файлы это специальная разметка карты, которая дает возможность сообщать
своим членам команды о своем местоположении на ней. Поддерживаются два типа loc-файлов:
proxy (используется в qizmo, NF-proxy etc) и собственный формат. Файлы собственного
формата должны находится в каталоге <b>loc</b>, а формата proxy каталоге <b>locs</b>,
так что никой путаницы быть не должно :). Лимиты для количества loc-точек сняты
для обоих типов разметок.</p>
<p>Преимущества и недостатки различных типов loc-файлов:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>proxy</b></td>
<td>
<p>Более распространенный формат. Представляет из себя список точек. Для каждой
точки задаются координаты (x,y,z) и сообщение выдаваемое по %l. Поскольку точка
выбирается по критерию минимального расстояния, то имеется проблема "точка за
стенкой", когда сообщение не имеет отношения к вашему действительному местоположению.
</p>
</td>
</tr>
<tr>
<td valign=top><b>qw262</b></td>
<td>Поддерживается только в qw262. Представляет из себя набор блоков-параллелипипедов.
При попадании текущего местоположения внутрь блока выдается соответствующее сообщение.
Сообщение может зависеть от команды, за которую вы играете, так что легко сделать
сообщения типа "Nash FR", "Enemy FR". При сравнимой степени детальности имеют
существенно меньший размер, чем loc-файлы формата прокси.</td>
</tr>
</tbody>
</table>
<p>Переменные и команды , относящиеся к loc-файлам:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>cl_loctype</b></td>
<td>Определяет формат loc-файлов используемых по умолчанию. 0 - собственный формат
(по умолчанию), 1- формат прокси.</td>
</tr>
<tr>
<td valign=top><b>cl_loadlocs</b></td>
<td>Определяет загружать ли loc-файл автоматически при смене карты. 0 - не загружать,
1 - пробовать загрузить loc-файл дефолтного типа, 2 - в случае неудачи попытаться
загрузить loc-файл другого типа (по умолчанию)</td>
</tr>
<tr>
<td valign=top><b>cl_locnear</b></td>
<td>Только для loc-файлов собственного формата. Если указанная точка не попадает
ни в один блок и эта переменная не равна 0, то выдается описание ближайшего блока.</td>
</tr>
<tr>
<td valign=top noWrap><b>loadloc locfile</b></td>
<td>Загружает loc-файл. Если расширение .loc не указано, то оно добавляется автоматически.
</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_unload</b></td>
<td>Выгружает текущий loc-файл из памяти.</td>
</tr>
</tbody>
</table>
<h3>Разметка карты</h3>
<p>В клиент встроена возможность создания loc-файлов собственного формата. Отметим,
что есть два варианта задания сообщений для loc-блоков: 1. используя индекс в
таблице &quot;msg&quot;, 2. непосредственное задание &quot;name&quot;. Команды
используемые для редактирования loc-файлов.</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>mark point</b></td>
<td>Устанавливает одну из вершин блока в текущей позиции. Если это уже вторая
вершина, то запрашивается сообщение, которое будет выдаваться для этого блока.
Если вы хотите использовать уже введенное один раз сообщение то достаточно ввести
% и его номер</td>
</tr>
<tr>
<td valign=top><b>mark point2</b></td>
<td>Аналогична предыдущей команде, но запрашивает сообщение в виде строки.</td>
</tr>
<tr>
<td><b>mark break</b></td>
<td>Отменяет по ошибке поставленную первую вершину блока</td>
</tr>
<tr>
<td><b>mark remove</b></td>
<td>Удаляет последний блок целиком</td>
</tr>
<tr>
<td><b>mark status</b></td>
<td>Выдает список всех сообщений </td>
</tr>
<tr>
<td><b>mark list [start [len]]</b></td>
<td>Выдает список loc-блоков</td>
</tr>
<tr>
<td valign=top><b>mark save</b></td>
<td>Запоминает созданный loc-файл в &lt;gamedir&gt;/loc/&lt;mapname&gt;.loc Внимание!
Существующий файл будет переписан без предупреждения.</td>
</tr>
<tr>
<td><b>mark position</b></td>
<td>выдает текущие координаты</td>
</tr>
<tr>
<td valign=top><b>mark center [x y]</b></td>
<td>Задает координаты центра карты, если <b>x</b> и<b> y</b> не заданы, то используется
для отметки двух симметричных точек, после задания второй центр вычисляется автоматически.</td>
</tr>
<tr>
<td valign=top><b>loc_selectblock n</b></td>
<td>Делает текущим блок n. Координаты и номера сообщений для блока выводятся в
консолью. В GL-версии он при этом отображается на экране. Снять выделение можно
командой <b>loc_selectblock -1</b></td>
</tr>
<tr>
<td noWrap><b>loc_selectnearestblock</b></td>
<td>Делает текущим блок, ближайший к позиции игрока</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_editblock param [value]</b></td>
<td>Если param равен <b>x1, y1, z1, x2, y2</b> или<b> z2</b>, то value прибавляется
к соответствующей координате текущего блока блока. Если параметр равен <b>msg1</b>
или <b>msg2</b>, то value задает новый номер для соответствующего сообщения. Если
параметр равен <b>name</b> то непосредственно задается сообщение для блока. Если
<b>value</b> не задано в команде, то оно запрашивается с консоли.</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_deleteblock [start [end]] </b></td>
<td>
<p>удаляет заданный интервал блоков (loc_point'ов) или текущий, отмеченный блок
(если интервал не задан).</p>
</td>
</tr>
</tbody>
</table>
<p>Собственно loc-файл представляет из себя последовательность специальных команд,
которые при загрузке создают соответствующие структуры данных. На самом деле loc-файлы
собственно формата просто исполняются командой <b>exec</b>, так что можно вставить
туда и другие команды.</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td><b>loc_msg n msg</b></td>
<td>Создает сообщение msg с номером n</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_point x1 y1 z1 x2 y2 z2 <br>
msg0 [msg1 [msg2 [msg3]]</b></td>
<td>Создает блок разметки. Первые 6 параметров задают координаты блока. Последующие
параметры задают номера сообщений, которые будут выдаваться для этого блока для
команд 0, 1, 2 и 3 соответственно. Если параметров не хватает, то подставляется
номер сообщения для команды 0.</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_point x1 y1 z1 x2 y2 z2 <br>
&quot;name&quot;</b></td>
<td>Вариант предыдущей команды, при котором сообщение задается непосредственно.</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_mirror (x|y|xy) [team1 team2]</b></td>
<td>Автоматически добавляет блоки путем симметричного отражения уже существующих
блоков относительно указанных осей. При этом сообщения для команд 0 и 1 (red и
blue в TeamFortress) для отраженных блоков меняются местами. Положение центра
карты должно быть предварительно задано командой <b>mark_center</b>. В случае,
если блок разметки создан с использованием второго варианта <b>loc_point</b>,
то отражаются только те блоки, которые содержат в <b>&quot;name&quot;</b> подстроку
<b>@team1</b>, причем для отраженного блока она заменяется на <b>@team2</b>.</td>
</tr>
<tr>
<td valign=top noWrap><b>loc_granularity</b></td>
<td>задает уровень детализации координат (т.е. значение на которое делятся реальные
координаты, диапазон значений 1 - 64). Перед каждой загрузкой лока значение устанавливается
на 50 для совместимости со старыми локами. Нужное значение необходимо прописывать
непосредственно в локе или в консоли перед созданием нового лока. При изменении
<b>loc_granularity</b> координаты загруженного лока и центр карты пересчитываются.
Также <b>loc_granularity</b> записывается в лок по команде <b>mark save</b> </td>
</tr>
<tr>
<td valign=top noWrap><b>mapgroup</b></td>
<td>Встроена команда mapgroup, позволяющая модифицировать алгоритмы поиска loc-файла и 24bit текстур.
Если loc-файл с именем mapname не найден, то делается попытка загрузить loc-файл
с именем groupname. Текстуры ищутся сначала в textures/mapname/, затем в
textures/groupname/ и далее как раньше. Имя текущей группы доступно через read-only 
переменную <tt>mapgroupname</tt>.

<pre>// выдает список групп
mapgroup
// очищает список групп
mapgroup clear
// задает группу groupname для карт map1, map2 ...
mapgroup groupname map1 [map2 ...]
// удаляет группу groupname
mapgroup groupname clear</pre>
Пример:
<pre>mapgroup 2fort5 2fort5r 2fort5l
mapgroup wellgl1 well6</pre>
</p>
</td>
</tr>
</tbody>
</table>
<p>Для симметричных карт (а такими являются большинство карт для TeamFortress)
можно разметить только половину (или даже четверть) карты, после чего командой
<b>loc_mirror</b> получить недостающую часть. Пример:<br>
<b>// keep2 :)<br>
mark center 0 0<br>
loc_point -61 44 2 -44 61 25 "@blue tower"<br>
loc_mirror xy blue red<br>
loc_mirror x blue yell <br>
loc_mirror y blue green</b></p>
<p>В сообщениях loc-файлов производится подстановка переменных. Это должно позволить
делать более универсальные loc-файлы. Например можно присвоить переменным <b>red,
blue</b>, значения our, enemy или вообще пустую строку для сокращения длины сообщения.<br>
</p>
<a name=trigger></a>
<h2>Триггеры</h2>
<p>В случае, если переменная <b>cl_triggers</b> не равна 0, клиент автоматически
выполняет следующие алиасы, если они определены:</p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td><b>f_mapstart</b></td>
<td>при коннекте к серверу или смене карты</td>
</tr>
<tr>
<td><b>f_mapend</b></td>
<td>при нормальном завершении карты</td>
</tr>
<tr>
<td><b>f_respawn</b></td>
<td>при рождении</td>
</tr>
<tr>
<td><b>f_death</b></td>
<td>в момент смерти</td>
</tr>
<tr>
<td valign=top><b>f_took</b></td>
<td>при взятии флага в TeamFortress. <i>внимание!</i> на некоторых картах не работает.
В клиент встроен хак (переменная <b>cl_f_took_hack</b>, default 1), позволяющий
нормально пользоваться <b>f_took/f_drop</b> на картах oppose1, dkeep2, warehau1,
wareh1r. </td>
</tr>
<tr>
<td><b>f_drop</b></td>
<td>в момент смерти, если вы несли флаг</td>
</tr>
<tr>
<td valign=top><b>f_low_health</b></td>
<td>если здоровье опустилось ниже величины, определяемой переменной <b>critical_health</b></td>
</tr>
<tr>
<td valign=top><b>f_low_armor</b></td>
<td>если армор опустился ниже величины, определяемой переменной <b>critical_armor</b></td>
</tr>
<tr>
<td><b>f_flash</b></td>
<td>вызывается в TeamFortress, если в вас попали <i>flash</i> гранатой</td>
</tr>
<tr>
<td><b>f_conc</b></td>
<td>вызывается в TeamFortress, если в вас попали <i>concussion</i> гранатой</td>
</tr>
<tr>
<td><b>f_bonusflash</b></td>
<td>
<p>когда вы что-то подбираете</p>
</td>
</tr>
<tr>
<td><b>f_weapon_change</b></td>
<td> когда меняется оружие, включая reload в TeamFortress</td>
</tr>
<tr>
<td><b>f_got_ammo</b></td>
<td>когда вы подбираете патроны</td>
</tr>
<tr>
<td><b>f_input_done</b></td>
<td>По завершении ввода командами <b>input, messagemode*</b></td>
</tr>
</tbody>
</table>
<p>Пример:<br>
<b>alias f_death say_team "@YI'm dead [%d]#def"</b></p>
<p>Можно создавать триггеры на изменение userinfo:</p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td  valign="top"><b>cl_setinfo_triggers</b></td>
<td>в эту переменную можно занести имена переменных (через пробел) на изменение
которых будут вызываться alias'ы. В случае срабатывания на переменную varname
вызывается алиас <b>f_setinfo</b>_<b><i>varname</i></b> c передачей трех параметров:
имени игрока, значения переменной и id игрока.<br>
В TeamFortress триггеры не вызываются для skin, topcolor и bottomcolor если они
относятся к игроку другой команды.</td>
</tr>
</tbody>
</table>
<p>Пример:<br>
<b>cl_setinfo_triggers &quot;rate&quot;<br>
alias f_setinfo_rate &quot;if %2 &gt; 5000 then say %1: your rate is set to %2.
Decrease rate to 5000!&quot;</b></p>
<a name=regexp></a>
<h2>regexp триггеры</h2>
<p>В клиент встроена возможность автоматически выполнять некоторые действия (алиас),
при обнаружении определенного сообщения в консоли или centerprint.</p>
<p><b>regexp</b> определяет на какие строки будет срабатывать триггер. В клиенте
использована библиотека <a href="ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/">PCRE</a>
(Perl-compatible regular expression library). Как писать регекспы можно прочитать
в документации к этой библиотеке.</p>
<p>Когда обнаруживается строка соответствующая regexp, триггер срабатывает и в
переменную <b>@0</b> заносится та часть строки, которая вызвала срабатывание триггера.
В переменные <b>@1, @2 ... @9</b> заносятся подстроки, которые соответствуют переменным
частям regexp. После этого вызывается алиас, имя которого совпадает с именем триггера.</p>
<p></p>
<p>Команды связанные с regexp триггерами:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>re_trigger [rt_name [regexp]]</b></td>
<td>без параметров выдает список всех триггеров; если regexp не задан, то выдает
опции действующие для триггера <b>rt_name</b>; иначе создает или изменяет триггер
<b>rt_name</b></td>
</tr>
<tr>
<td noWrap><b>re_trigger_options rt_name option_list</b></td>
<td>изменяет опции для указанного триггера</td>
</tr>
<tr>
<td><b>re_trigger_delete rt_name</b></td>
<td>удаляет указанный триггер</td>
</tr>
<tr>
<td valign=top><b>re_trigger_enable rt_name1 [rt_name2...]</b></td>
<td>разрешает срабатывание одного или нескольких триггеров</td>
</tr>
<tr>
<td valign=top><b>re_trigger_disable rt_name1 [rt_name2...]</b></td>
<td>запрещает срабатывание одного или нескольких триггеров</td>
</tr>
<tr>
<td valign=top noWrap><b>re_trigger_match &lt;trigger_name&gt; &lt;string&gt;</b></td>
<td valign=top>позволяет передать строку string в триггер trigger_name. Если строка
соответствует регекспу, то вызовется соответствующий алиас<br>
</td>
</tr>
</tbody>
</table>
<p>В команде <b>re_trigger_options</b> возможны следующие опции</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>mask value</b></td>
<td><b>value</b> представляет из себя битовую маску, определяющую, на какие типы
сообщений срабатывает триггер.
<ul>
<li>1 - pickup messages
<li>2 - death messages
<li>4 - critical messages (большинство сообщений в TeamFortress)
<li>8 - chat
<li>16 - centerprint
<li>32 - вывод команды echo
<li>64 - все прочие строки, выводимые в консоль </li>
</ul>
<p>по умолчанию триггер создается с маской 31</p>
</td>
</tr>
<tr>
<td valign=top noWrap><b>interval value</b></td>
<td>задает минимальный интервал срабатывания триггера (в секундах); если повторное
срабатывание произошло раньше, то оно игнорируется. Значение по умолчанию - 0</td>
</tr>
<tr>
<td valign=top noWrap><b>final</b></td>
<td>если произошло срабатывание этого триггера, то оставшиеся в списке триггеры
не проверяются. Триггеры обрабатываются в порядке обратном порядку их определения.</td>
</tr>
<tr>
<td valign=top noWrap><b>notfinal</b></td>
<td>срабатывание триггера не прекращает проверку других триггеров (по умолчанию)</td>
</tr>
<tr>
<td valign=top noWrap><b>remove</b></td>
<td>строка на которой произошло срабатывание триггера не выводится на экран.</td>
</tr>
<tr>
<td valign=top noWrap>
<p><b>noremove</b></p>
</td>
<td>строка на которой произошло срабатывание триггера выводится на экран (по умолчанию)</td>
</tr>
<tr>
<td valign=top noWrap><b>nolog</b></td>
<td>строка на которой произошло срабатывание триггера не выводится в log-файл</td>
</tr>
<tr>
<td valign=top noWrap><b>log</b></td>
<td>строка на которой произошло срабатывание триггера выводится в log-файл (по
умолчанию) </td>
</tr>
<tr>
<td valign=top noWrap><b>noaction</b></td>
<td>
<p>при срабатывании триггера соответствующий алиас не вызывается; нет необходимости
его создавать, если все что вам нужно это применить опцию remove :)</p>
</td>
</tr>
<tr>
<td valign=top noWrap><b>action</b></td>
<td>при срабатывании триггера соответствующий алиас вызывается (по умолчанию)</td>
</tr>
<tr>
<td valign=top noWrap><b>enable</b></td>
<td>разрешает срабатывание триггера</td>
</tr>
<tr>
<td valign=top noWrap><b>disable</b></td>
<td>запрещает срабатывание триггера</td>
</tr>
</tbody>
</table>
<p>Во избежание читерства, список доступных в алиасах команд, срабатывающих по
триггеру, ограничен. Разрешено выполнение alias'ов и запуск конфигов, операции
с переменными, и следующие команды:</p>
<blockquote>
<p><b>play playvol stopsound say say_team say_id sayid say_to_team echo alias
unalias re_trigger re_trigger_options re_trigger_delete re_trigger_enable re_trigger_disable
re_trigger_match hud_add hud_position hud_width hud_remove hud_bg hud_enable hud_disable
hud_move hud_bringtofront bind record stop register unregister set (и все ее виды)
inc toggle rcon users user if/then/else if_exists exec</b></p>
</blockquote>
<p>В TeamFortress также разрешено использовать команду <b>impulse</b> c параметром
из списка: 23(<b>flaginfo</b>), 99(<b>changeclass</b>), 101-109(команды смены
класса), 135(<b>inv</b>), 144 (<b>showclasses</b>), 145(<b>showscores</b>).</p>
<p>Примеры:<br>
// Setting detpack<b><br>
re_trigger dp "^Setting detpack for (.+) seconds"<br>
re_trigger_options dp final remove mask 4<br>
alias dp "say_team Detpack for @1 seconds at %l"<br>
</b></p>
<p>// removes spam from inv command output<b><br>
re_trigger inv_spam "(^You\Dre in team|\w+ armor|^Skin \:|^Colors \:|^Scanner|^$)"
<br>
re_trigger_options inv_spam final remove nolog mask 4 noaction<br>
</b></p>
<p>// результат id заносится в переменную @last_id_nick<b><br>
register last_id_nick<br>
re_trigger postid "(?m)\n\n\n\n(.+)\n(Friendly)"<br>
re_trigger_options postid final mask 16<br>
alias postid "last_id_nick @1"<br>
</b></p>
<p><b>Важное примечание!</b><br>
Триггеры не работают на отладочные сообщения, типа, snd_show 1. В TeamFortress
не работают trigger'ы на: команды <b>showloc</b> и <b>id</b> (врага), на сообщение
об использовании вашего диспенсера врагами.<br>
</p>
<p>Команды <b>alias, unalias, viewalias, cmdlist, cvarlist, unregister, hud_list,
re_trigger, re_trigger_enable, re_trigger_disable, re_trigger_delete, hud_enable,
hud_disable, hud_move, hud_bg hud_width и hud_remove </b>понимают regexp'ы. Соответствующая
операция затрагивает только те объекты, имя которых подпадает под заданный regexp,
например:<br>
<b>//список переменных, начинающихся с vid_<br>
cvarlist &quot;^vid_&quot;<br>
//удаление всех переменных, заканчивающихся на _test<br>
unregister &quot;_test$&quot;<br>
//список алиасов, содержащих в имени gren1 или gren2<br>
alias &quot;gren(1|2)&quot;</b> </p>
<a name=hud></a>
<h2>Настраиваемый hud</h2>
<p>Можно постоянно выводить на экран информацию, определяемую пользователем. Hud
состоит из отдельных элементов, каждый из которых может быть независимо расположен
на экране в любом удобном для пользователя месте.</p>
<p>Команды связанные с hud:</p>
<table cellspacing=0 cellpadding=3 border=0 width="100%">
<tbody>
<tr>
<td valign=top><b>cl_hud</b></td>
<td>если эта переменная равна 0 (по умолчанию 1), то все hud'ы не отображается.</td>
</tr>
<tr>
<td valign=top><b>hud_add hud_name type param</b></td>
<td>
<p>создает или изменяет элемент hud с именем <b>hud_name</b>; возможны следующие
типы элементов:
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top><b>cvar</b></td>
<td>выводится значение переменной; в этом случае param должен быть именем переменной
</td>
</tr>
<tr>
<td valign=top><b>str</b></td>
<td>выводится строка, задаваемая param; перед выводом производится подстановка
переменных и %макросов</td>
</tr>
<tr>
<td valign=top><b>std</b></td>
<td>
<p>выводится один из стандартных элементов; param может быть</p>
<ul>
<li><b>fps</b> - счетчик fps
<li><b>lag</b> - lagometer
<li><b>clock</b> - часы
<li><b>speed</b> - спидометр </li>
</ul>
</td>
</tr>
<tr>
<td valign=top><b>img</b></td>
<td>Выводится картинка с именем param, ищется в каталогах <b>textures/gfx/</b>, <b>textures/wad/</b> и <b>gfx/</b>. В качестве картинки могут быть использованы те же типы файлов, что и для текстур &mdash; DDS, JPG, PNG, TGA и PCX. Работает только в GL-версии.</td>
</tr>
</tbody>
</table>
<b>hud_add</b> с именем уже существующего элемента не делает его видимым, если
он был ранее убран командой <b>hud_disable</b> </td>
</tr>
<tr>
<td valign=top><b>hud_position hud_name pos x y</b></td>
<td> указывает расположение элемента hud на экране; pos задает положение точки,
откуда отсчитывается смещения x и y (измеряемые в символах):
<ol>
<li>верхний левый угол
<li>верхний правый угол
<li>нижний правый угол
<li>нижний левый угол
<li>верх, по центру
<li>низ по центру. </li>
</ol>
</td>
</tr>
<tr>
<td valign=top><b>hud_width hud_name width</b></td>
<td> принудительно устанавливает ширину элемента <b>hud_name</b> при необходимости
отрезая лишнее или дополняя пробелами. Диапазон <b>width</b>: 0-128, значение
0 (default) отменяет форсирование ширины. Команда может применяться к нескольким
элементам при задании regexp вместо конкретного name.</td>
</tr>
<tr>
<td valign=top><b>hud_bg hud_name bg_color</b></td>
<td>задает цвет фона элемента hud; 0 - прозрачный фон (по умолчанию)</td>
</tr>
<tr>
<td valign=top><b>hud_move hud_name dx dy</b></td>
<td>сдвигает элемент hud; смещения <b>dx</b>, <b>dy</b> измеряются в символах</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_enable hud_name [hud_name2...]</b></td>
<td>разрешает отображение одного или нескольких элементов hud</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_disable hud_name [hud_name2...]</b></td>
<td>запрещает отображение одного или нескольких элементов hud</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_remove hud_name</b></td>
<td>уничтожает элемент hud</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_list</b></td>
<td>выдает список элементов hud</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_blink name period mask</b></td>
<td>позволяет делать мигающие элементы hud. name  - имя элемента hud 
(разрешены regexp), period - период мигания в миллисекундах, mask - определяет, 
что именно должно мигать: 0 - ничего, 1 - текст, 2 - фон, 3 - и фон и текст.
</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_font name font</b></td>
<td>задает шрифт для элемента hud <b>name</b>. <b>font</b> &mdash; имя файла со шрифтом, ищется в каталогах <b>textures/charsets/</b> и <b>textures/</b>. См. также <a href="#load_charset">load_charset</a>. Работает только в GL-версии.
</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_alpha name value</b></td>
<td>задает прозрачность для элемента hud, значение от 0 до 1 (0 &mdash; невидимый, 1 &mdash; непрозрачный). Работает только в GL-версии.
</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_button name alias_name</b></td>
<td>Вызывается alias_name, когда нажимается кнопка мыши над элементом name. В качестве первого аргумента алиасу передается номер кнопки (1 - левая, 2 - правая и т.д.), в качестве второго - имя hud'а.
</td>
</tr>
<tr>
<td valign=top noWrap><b>hud_hover name alias_name</b></td>
<td>Вызывается alias_name, когда курсор мышки наводится на или убирается с элемента name. В качестве первого аргумента алиасу передается 1, если курсор входит в пределы hud'а и 0 если покидает их. В качестве второго аргумента алиасу передается имя hud'а.
</td>
</tr>
<tr>
<td valign=top noWrap><b>m_show</b></td>
<td>Включает мышиный курсор, мышка при этом управляет курсором, а не игроком.
</td>
</tr>
<tr>
<td valign=top noWrap><b>m_hide</b></td>
<td>Прячет мышиный курсор, восстанавливается обычное управление.
</td>
</tr>
<tr>
<td valign=top noWrap><b>input cvar x y len [bg]</b></td>
<td>позволяет вводить текст в переменную <b>cvar</b>. <b>x</b> и <b>y</b> задают
позицию на экране относительно верхнего правого угла. <b>len</b> задает длину
поля ввода. <b>bg</b> задает цвет фона (по умолчанию 0 - прозрачный). По окончании
ввода данных (при нажатии ENTER или ESC) вызывается триггер <b>f_input_done</b>.</td>
</tr>
</tbody>
</table>
<p>В качестве аргументов команд <b>hud_enable</b>, <b>hud_disable</b>, <b>hud_remove</b>, <b>hud_move</b>, <b>hud_width</b>, <b>hud_bg</b>, <b>hud_font</b>, <b>hud_alpha</b>, <b>hud_blink</b> может быть задано регулярное выражение, в таком случае команда применяется ко всем элементам, имя которых подходит под регэксп.</p>
<p>Примеры:</p>
<p><b>// Счетчик fps в правом нижнем углу, аналогично show_fps 1<br>
hud_add fps std fps<br>
hud_position fps 3 0 0</b></p>
<p><b>// Переменная class над левым нижнем углом<br>
hud_add class cvar class<br>
hud_position class 4 0 3</b></p>
<p><b>// карта и время по центру экрана внизу.<br>
hud_add test str "@mapname-@time"<br>
hud_position test 6 0 0</b><br>
</p>
<p> <b>// Включение выключение отображения hud'ов:<br>
alias +scores &quot;cl_hud 0;+showscores&quot;<br>
alias -scores &quot;cl_hud 1;-showscores&quot; <br>
bind TAB +scores </b></p>
<p> <b>// Все hud'ы делаются полупрозрачными:<br>
hud_alpha ^ 0.5</b></p>
<a name=tcl></a>
<h2>Поддержка Tcl</h2>
<p>Поддержка Tcl пока экспериментальна и доступна только в <a href="http://se7en.newmail.ru/">unofficial билде se7en'а</a>.
Почему был выбран именно Tcl? Во-первых, это простота встраивания: Tcl, в
отличие от, например, Perl, изначально был разработан так, чтобы его легко
можно было встроить в существующее приложение, написанное на C (в нашем случае QW262).
Во-вторых, поддержка Tcl не требует наличия дополнительных библиотек и файлов,
кроме tcl.dll. Ну и наконец, достаточно простой синтаксис, с которым можно ознакомиться,
например, <a href="http://tclstudy.narod.ru/tcl/">здесь</a>.</p>
<p>В клиент добавляются следующие 3 команды:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tr>
<td valign=top noWrap><b>tcl_eval строка</b></td>
<td>Выполнение строки как Tcl-кода, результат последней команды выводится на консоль.</td>
</tr>
<tr>
<td valign=top noWrap><b>tcl_exec файл</b></td>
<td>Выполнение Tcl-скрипта, ищется там же, где и qw-скрипты, выполняемые по команде exec.</td>
</tr>
<tr>
<td valign=top noWrap><b>tcl_proc имя [параметры]</b></td>
<td>Выполнение Tcl-процедуры &laquo;имя&raquo; с передачей параметров. Процедура должна быть ранее определена (через команды tcl_eval или tcl_exec).</td>
</tr>
</table>
<p>В Tcl-скриптах доступны все qw-переменные по своим именам.  Поскольку эти
переменные глобальные, внутри процедур их следует объявлять командой global,
либо просто перед именем переменной ставить <b>::</b>, например <tt>set x
$::fov</tt>.
<p>Кроме этого, для взаимодействия с клиентом в интерпретатор Tcl добавлены команды:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tr>
<td valign=top noWrap><b>cmd строка</b></td>
<td>Выполняет строку как qw-команду или алиас.</td>
</tr>
<tr>
<td valign=top noWrap><b>alias имя {аргументы} {команды}</b></td>
<td>Команда аналогична встроенной Tcl-команде proc, но кроме определения
процедуры определяется qw-алиас с заданным именем, который может быть вызван
из QW как обычный алиас. Т.е. его можно забиндить на кнопку, создать триггер и
т.д.</td>
</tr>
</table>
<p>Небольшой пример:</p>
<p><b>alias +wswitch {weapon} {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set ::last_weapon $::cl_currentweapon<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd impulse $weapon<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd +attack<br>
}<br>
alias -wswitch {} {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd -attack<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd impulse $::last_weapon<br>
}<br>
cmd bind MOUSE3 +wswitch 2 ;# выстрел из бумстика<br>
</pre></b></p>
<a name=qw262></a>
<h2>QW262</h2>
<p>При работе с сервером QW262 у клиента появляются дополнительные возможности:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tr>
<td colspan=2><b>say_id (id | uid) text</b></td>
<td>Посылает сообщение игроку с указанным <b>id</b> или <b>uid</b></td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>sayid text</b></td>
<td>Посылает сообщение одному игроку (его <b>id</b> или <b>uid</b> должны быть
предварительно занесены в переменную <b>uid</b>)</td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>messagemode3</b></td>
<td>Позволяет ввести строчку с консоли, а потом посылает ее по <b>sayid</b></td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>say_to_team team text</b></td>
<td>Посылает сообщение указанной команде. Полезно на картах типа hunted или border.</td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>cmd upload localname remotename</b></td>
<td>Закачивает файлы на сервер. Пути записываются от корня quake. Требуется предварительно залогиниться командой cmd techlogin master_rcon (mvdsv).</td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>rcon ls dir</b></td>
<td>Выдает список файлов в директории.</td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>rcon rm dir file</b></td>
<td>Удаляет файл в директории.</td>
</tr>
<tr>
<td valign=top noWrap colspan=2><b>rcon rmdir dir</b></td>
<td>Удаляет каталог.</td>
</tr>
</table>
<p>Примеры:</p>
<p><b>uid lamer<br>
sayid "You are LAME!"<br>
// hunted<br>
say_to_team red "Please remove sniper near respawn"</b> </p>
<h3>Отличия сервера QW262 от стандартного сервера версии 2.30</h3>
<p>
Имеется поддержка модов, написанных на C. Их можно компилировать в native code (dll или so) или в qvm, как в Quake3. 
</p>
<p>Сервер под Win32 устанавливает сам себе высокий приоритет (HIGH_PRIORITY_CLASS).
Это необходимо для того, чтобы при игре на локальном сервере под Windows 9x не
возникал большой PL. Если вы по какой-либо причине хотите отключить автоматическую
установку приоритета, запускайте сервер с параметром <b>-nopriority</b>. Так же
устранена причина большого пинга, в случае если сервер запущен на Windows 9x.
Сервер по умолчанию использует 32 Мегабайта памяти.<br>
</p>
<p>Сервер перестал падать, если количество entities переваливает за 512. Entities выше 512 просто не видны.</p>
<p>Для уменьшения сетевого траффика сервер осуществляет <a href="#filter">фильтрацию
сообщений</a>, в соответствии с установленной игроками в userinfo переменной <b>filter</b>.
</p>
<p>В коде сервера были произведены некоторые изменения, которые позволили починить проваливание пушки/диспенсера скозь пол в картах.</p>
<p>В сервер введена поддержка для эффекта флэш-гранаты в TeamFortress, который
нельзя убрать на клиенте. При соответствующем коде на QuakeC (надо еще и TF править
:) ) клиент под действием флэша просто не получает информации об entities с сервера.
</p>
<p>В сервере сделана поддержка нескольких категорий <b>rcon</b>. Обладатели обычного
<b>rcon_password</b> не могут изменить некоторые настройки сервера (<b>serverinfo,
localinfo, gamedir</b>), использовать <b>rcon say</b> и выключить лог использования
<b>rcon</b>. Пароль для администратора, который позволяет выполнять любые команды
задается командой <b>master_password</b>. Эта команда принимается только из <b>server.cfg</b>
</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tbody>
<tr>
<td valign=top noWrap><b>sys_sleep</b></td>
<td>Интервал времени в миллисекундах, на которое сервер
отдает управление на один серверный цикл. Не понимаешь, что этот параметр делает
- не трогай :) (по умолчанию 8 для Win9x, 0 для NT4/Win2000/WinXP/Unix).</td>
</tr>
<tr>
<td valign=top noWrap><b>rcon kick</b></td>
<td>при использовании этой команды все игроки на сервере получают сообщение от
том, кто применил kick.</td>
</tr>
<tr>
<td valign=top><b>sv_nailhack</b></td>
<td>При установке этой переменной в 1 изменяется алгоритм сжатия информации о
гвоздях, что приводит к уменьшению сетевого траффика. Значение по умолчанию 0.</td>
</tr>
<tr>
<td valign=top><b>sv_maxrate</b></td>
<td><b>rate</b> больше, чем указано в данной переменной не разрешен. При превышении
<b>rate</b> клиенту устанавливается в <b>sv_maxrate</b>. Значение по умолчанию
10000. Максимальное значение: 15000.</td>
</tr>
<tr>
<td valign=top><b>sv_loadentfiles</b></td>
<td>Если установить ее в 1, то при загрузке карты сервер сначала пытается прочесть
entities из файла mapname.ent в каталоге maps. Если такого файла нет, то entities
берутся из mapname.bsp (по умолчанию 0).</td>
</tr>
<tr>
<td valign=top><b>sv_announcercon</b> </td>
<td>Если установить ее в 1, то сервер рассказывает в консоли, какая Rcon-команда
пришла и откуда (по умолчанию 0).</td>
</tr>
<tr>
<td valign=top><b>sv_newpause</b> </td>
<td>Если установить ее в 1 (по умолчанию), то при снятии паузы сервер выдает в консоль отсчет 5, 4, 3, 2, 1 и только потом снимает паузу.</td>
</tr>
<tr>
<td valign=top><b>pm_jumpfix</b></td>
<td>Установка в 1 (по умолчанию 0) включает фикс предсказания прыжков на сервере. Распрыги при
этом не срываются, но слегка изменяется физика. Значение 2 форсирует jumpfix на клиенте, 
даже если сервер без jumpfix. Иначе клиентский jumpfix выставляется в 
соответствии с типом сервера.</td>
</tr>
<tr>
<td valign=top><b>pm_bunnyspeedcap</b></td>
<td>Ограничитель скорости, которую можно набрать за счет air-контроля. Представляет
из себя коэффициент к максимальной скорости передвижения. Таким образом солдат
в Teamfortress (скорость 240) при <b>pm_bunnyspeedcap 1.5</b> не сможет распрыгаться
быстрее 240*1.5=360. Данное ограничение не распространяется на другие методы набора
скорости (grenade и rocket-jump). Значение по умолчанию - 0 (нет ограничения скорости).</td>
</tr>
<tr>
<td valign=top><b>logfile</b></td>
<td>Действительно пишет лог, а не ту пародию, которая получается в 2.30</td>
</tr>
<tr>
<td valign=top><b>logerrors</b></td>
<td>Создается специальный лог (&lt;gamedir&gt;/qerror.log), в который пишутся
предсмертные сообщения сервера при падении. Повторное применение команды выключает
лог. </td>
</tr>
<tr>
<td valign=top><b>logrcon</b></td>
<td>Создается специальный лог (&lt;gamedir&gt;/rcon.log) в который протоколируется
использование rcon (включая ник игрока). Повторное применение команды выключает
лог.</td>
</tr>
<tr>
<td valign=top><b>admin</b></td>
<td>Подавший эту команду игрок будет получать информацию обо всех случаях применения
rcon. Отключается этот режим командой <b>admin off</b></td>
</tr>
</tbody>
</table>
<h3>Поддержка server-side демок (Multi View Demos: MVD)</h3>
<p>Возможна запись демки на сервере. В нее попадают действия всех игроков. <i>Внимание</i>:
максимальное количество entities, записываемых в MVD демку увеличено до 300 (в
QW Extended aka mvdsv - 196). На некоторых TF-картах entities слишком много и
часть entities просто не попадает в демку. Если в какой-либо демке их будет больше
196, то эта демка играться будет только в клиенте QW262.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="3">
<tr>
<td valign="top" nowrap><b>record demoname</b></td>
<td>Начинает запись демки <b>demoname</b> на сервере. Демка пишется в каталог
&lt;quake_dir&gt;/&lt;gamedir&gt;/demos. В <b>serverinfo</b> выставляется переменная
<b>serverdemo</b> со значением <b>demoname</b>.</td>
</tr>
<tr>
<td valign="top"><b>stop</b></td>
<td>Останавливает запись демки. Также демка автоматически останавливается по окончании
мапы.</td>
</tr>
<tr>
<td valign="top"><b>cancel</b></td>
<td>Останавливает запись демки и стирает ее с диска.</td>
</tr>
<tr>
<td valign="top"><b>script</b></td>
<td>Запускает скрипт на сервере.<br>
Пример: script &lt;scriptname&gt; [&lt;param1&gt; &lt;param2&gt; ...]<br>
Сервер ищет скрипт в текущей директории и запускает его. Можно указать путь для запуска вне gamedir-директории, но только одну. Допускается ../ .<br>
Раширение добавляется автоматически (.bat для windows, .qws для linux).<br>
Возможна простая подстановка параметров. Если параметр начинается со знака @, то осуществляется подстановка значения из указанной переменной в serverinfo/localnfo.
Пример:<br>
<pre>script myscript @hostname
	Сервер запустит скрипт "myscript.qws" и передаст ему в качестве параметра hostname сервера.
script myscript "@hostname"
	На этот раз, уже строка передается в качестве параметра.
	Подстановка не работает, если текст заключен в двойные кавычки.
</pre>
</td>
</tr>
<tr>
<td valign="top"><b>demoinfoadd</b></td>
<td>Недокументированная команда в mvdsv, но она есть и что-то делает. :)</td>
</tr>

<tr>
<td valign="top"><b>demoinforemove</b></td>
<td>Недокументированная команда в mvdsv, но она есть и что-то делает. :)</td>
</tr>

<tr>
<td valign="top"><b>demoinfo</b></td>
<td>Недокументированная команда в mvdsv, но она есть и что-то делает. :)</td>
</tr>
<tr>
<td valign="top"><b>demolist</b></td>
<td>Выдает список демок, которые есть на сервере с размерами и сообщает сколько
еще сталось места для новых.</td>
</tr>
<tr>
<td valign="top" nowrap><b>rmdemo demoname<br>
rmdemo *token<br>
rmdemo *</b></td>
<td>
<p>Удаляет демки с сервера: конкретную, с именем <b>demoname</b>,<br>
все, содержащие в имени <b>token</b>,<br>
все.</p>
</td>
</tr>
<tr>
<td valign="top" nowrap><b>rmdemon n</b></td>
<td>Удаляет демку с сервера по номеру.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demofps</b></td>
<td>fps, c которым записываются демки. По умолчанию - 20 (этого вполне достаточно,
поскольку при проигрывании MVD демок производится интерполяция).</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demopings</b></td>
<td>Интервал в секундах, через который в демке фиксируются пинг игроков.По умолчанию
- 3.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demomaxsize</b></td>
<td>Максимальный разрешенный размер демки в килобайтах. По умолчанию выключено.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demomaxdirsize</b></td>
<td>Максимальный разрешенный размер каталога с демками в килобайтах. По умолчанию выключено.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demonovis</b></td>
<td>При значении 1 (по умолчанию) в демку пишутся все entities, даже если их не
видит никто из игроков</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demouseсache</b></td>
<td>Если установить в 1, то демка пишется в через буфер в памяти (по умолчанию
- 0).</td>
</tr>
<tr>
<td valign="top" nowrap><b>-democache size</b></td>
<td>ключик командной строки, задающий размер буфера для демки в Килобайтах.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demoсachesize</b></td>
<td>(read-only) Показывает размер буфера для демки в Килобайтах.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demomaxsizeoverwrite</b></td>
<td>Задает максимальное значение размера демки (в килобайтах, 100 по умолчанию), которая будет перезаписана при старте новой демки с таким же именем.
Если размер превышен, то новая демка переименовывается.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demoPrefix</b></td>
<td>Строка, добавляемая в качестве префикса к названию демки.
</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demoSuffix</b></td>
<td>Строка, добавляемая в качестве суффикса к названию демки.</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_onrecordfinish</b></td>
<td>Эта переменная может содержать название скрипта, который запустится по окончании записи демки. Например, sv_onrecordfinish myscript.
Скрипт не выполняется, если запись была отменена.
</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_ondemoremove</b></td>
<td>Эта переменная недокументирована в mvdsv, но она есть и за что-то отвечает. :)
</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demotxt</b></td>
<td>Эта переменная недокументирована в mvdsv, но она есть и за что-то отвечает. :)
</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demodir</b></td>
<td>Указывает директорию в которую будут записываться демки.
</td>
</tr>
<tr>
<td valign="top" nowrap><b>sv_demoextranames</b></td>
<td>Если включена (1), то название демки содержит имена игроков вместо названия команд.
Например: dag_pietro_vs_insane_balt, вместо la_vs_hgc.
</td>
</tr>
<tr>
<td valign="top" nowrap><b>allow_download_demos</b></td>
<td>Если 1, то с сервера можно качать демки.
</td>
</tr>
</table>
<p>В сервере изменена обработка userinfo. Клиентам рассылаются изменения только
существенных переменных. Это уменьшает траффик, размер демок и решает проблему с
переполнением userinfo.</p>

<p>
Unix версия сервера понимает дополнительные ключи командной строки:
<ul><li>-pidfile file записывает в указанный файл pid процесса сервера
<li>-daemon сервер становится демоном</li>
</ul>

<p>В сервер встроена технология ускоренной закачки файлов. Переменная <b>sv_maxdownloadrate</b> отвечает
за ограничичение скорости закачки. По умолчанию она равна 0 и скорость закачки ограничивается <b>sv_maxrate</b>.
Максимальное значение <b>sv_maxdownloadrate</b> - 100000.
Со стороны клиента скорость закачки определяется <b>setinfo drate</b> (или <b>rate</b> при отсутствии <b>drate</b>).

<p>Переменная <b>sys_extrasleep</b> в Unix версии переименована в <b>sys_sleep</b> и измеряется в миллисекундах, а не микросекундах, для совместимости с Win32 версией.
Дефолтное значение для Unix равно 5 (иначе сервер для Linux с новым сетевым кодом жрал 100% процессора).
</p>

Дополнительные возможности по ведению логов сервера: 
<ul><li>переменные <b>sv_logfname</b>,
<b>sv_rconlogfname</b>, <b>sv_errorlogfname</b>, <b>sv_fraglogfname</b> задают имена 
соответствующих логов. 
<li>переменные <b>sv_logprefix</b>, <b>sv_rconlogprefix</b>, <b>sv_errorlogprefix</b>, 
<b>sv_fraglogprefix</b> задают префиксы для каждой строки соответствующих логов.
</ul>
В префиксах распознаются макросы, которые понимает стандартная функция strftime.
Пример:
<pre>// меняет имя rcon-лога на rcon_tf.log
sv_rconlogfname rcon_tf
// задает префикс выдающий в лог дату и время
sv_rconlogprefix [%d-%m-%Y %H:%M:%S]
</pre>
</p>
<p>Введена возможность автоматически писать демки всех игр. Включается
переменной <b>sv_demoautorecord</b> (может быть включена только из server.cfg).
Значение 1 включает запись, если же задать строку, то демки пишутся только для
gamedir, совпадающего со строкой. Это полезно, чтобы не писать демки голосования
с использованием мода ThunderVote.<br>
Автоматическая запись ведется все время пока на сервере присутствуют игроки.
Если с сервера уходит последний клиент, запись останавливается. При смене карты
и при заходе на пустой сервер начинается новая демка. Info файл, соответствующий
демке теперь содержит информацию о всех игроках, которые заходили на сервер в
процессе игры.<br>
Запуск скриптов через rcon по дефолту отключен,
включается переменной <b>scriptcmdallowed</b> (может быть измененa только
из server.cfg). Это не относится к автоматически вызываемым скриптам по
<b>sv_onrecordfinish</b>, <b>sv_ondemoremove</b>.
Кстати эти переменные тоже могут быть изменены только из server.cfg.
</p>
<p>Существует возможность записи лога консоли при записи демки. Управляется переменной <b>sv_demolog</b>, по умолчанию включено.</p>

<h3>Отличия полной версии сервера</h3>
<p>Сервер QW262 в версии full работает на измененном протоколе. Исходники протокола
закрыты, поэтому подключиться к такому серверу могут только клиенты версии QW262
full. Все прокси с встроенными читами также отсекаются. По умолчанию клиент работает
на протоколе совместимом с 2.30. Чтобы подсоединиться к серверу QW262 full необходимо
дать в консоли команду <b>version</b> либо в командной строке ключик <b>-ver262</b>.</p>
<p>В сервер QW262 версии full имеет возможность проверять модели и скины у клиентов
для предотвращения читов. Клиенты с измененными моделями или скинами отсоединяются.
Вот команды сервера:</p>
<table cellspacing=0 cellpadding=3 width="100%" border=0>
<tr>
<td valign=top><b>allow_old_clients</b></td>
<td>Значение 1 (по умолчанию 0) разрешает соединение с сервером QW262 full на
протоколе 2.30.</td>
</tr>
<tbody>
<tr>
<td valign=top><b>addskin skin</b></td>
<td>Добавляет skin.pcx к списку проверяемых. До 20 различных скинов может проверяться.
</td>
</tr>
<tr>
<td valign=top noWrap><b>addmodel model</b></td>
<td>Добавляет model.mdl к списку проверяемых. До 20 различных моделей может проверяться.</td>
</tr>
<tr>
<td valign=top noWrap><b>removeskins</b></td>
<td>
<p>Очищает список проверяемых скинов.</p>
</td>
</tr>
<tr>
<td valign=top noWrap><b>removemodels</b></td>
<td>Очищает список проверяемых моделей.</td>
</tr>
</tbody>
</table>
<p>Имеется возможность запросить с клиента скриншот для проверки.</p>
<h2>Кто написал все это безобразие</h2>
<p>Оригинальные исходники (c) <a target=_top href="http://www.idsoftware.com/">Id
software</a><br>
использован код нижеперечисленных людей<br>
<u>-=MD=-</u> (Александр Пучков), <br>
<u>Tonik</u> (Антон Гаврилов, tonik@vipmail.ru, <a target=_top href="http://zquake.frag.ru">ZQuake</a>),
<br>
<u>HighlandeR</u> (Bartlomiej Rychtarski , highlander@, <a target=_top href="http://www.wsb.poznan.pl/~pawel/q/q/ktpro/develop/">QW
Extended</a>),<br>
<u>Sergio</u> (k_sergio@nm.ru)<br>
<u>5AT0H</u> (5AT0H@aport.ru)<br>
<u>don</u> (don@sztaki.hu, <a target=_top href="http://rc.sch.bme.hu/surmoclient/">surmoclient</a>)<br>
<u>Vic</u> (Victor Luchits, vic@captured.com)<br>
<u>fuh</u> (A. Nourai, fuhquake@hotmail.com, <a target=_top href="http://www.fuhquake.net">FuhQuake</a>)<br>
<u>Azazello</u> , <a target=_top href="http://mqwcl.qhlan.org/">MQWCL</a>.</p>
<p>В данный момент развитием клиента занимается <u>[2WP]BorisU</u> <br>
(Борис Усиевич, borisu@newmail.ru).</p>
<h2>Где оно живет?</h2>
<p>Скачать последнюю версию, пожаловаться на баги, попросить новые фичи можно
на <a target=_top href="http://qw262.da.ru">страничке QW262</a>.</p>
<p class=credits>Документация обновлена
<!-- #BeginDate format:Ge1a -->25.01.2005 6:27 PM<!-- #EndDate -->
</p>
</body>
</html>
